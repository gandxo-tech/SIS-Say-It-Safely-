<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="description" content="SIS - Say It Safely - R√©seau social nouvelle g√©n√©ration avec messages anonymes">
    <link rel="canonical" href="https://sis-say-it-safely-pi.vercel.app/">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#667eea">
    <link rel="icon" type="image/png" href="https://i.ibb.co/tGCTMvk/logo.png">
    <link rel="apple-touch-icon" href="https://i.ibb.co/tGCTMvk/logo.png">
    <title>SIS - Say It Safely</title>

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-97TCHJ33KW"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-97TCHJ33KW');
    </script>
</head>
<body>
    <!-- Loader -->
    <div class="loader-screen" id="loaderScreen">
        <div class="loader-container">
            <img src="https://i.ibb.co/tGCTMvk/logo.png" alt="SIS Logo" class="loader-logo">
            <div class="loader-spinner"></div>
            <div class="loader-text">Chargement de SIS...</div>
        </div>
    </div>

    <!-- Onboarding Screen -->
    <div class="onboarding-screen" id="onboardingScreen">
        <button class="skip-btn" id="skipBtn">Passer</button>
        
        <div class="onboarding-slides" id="onboardingSlides">
            <!-- Slide 1 - Bienvenue -->
            <div class="onboarding-slide active" data-slide="0">
                <div class="slide-content">
                    <img src="https://i.ibb.co/tGCTMvk/logo.png" alt="SIS Logo" class="slide-logo">
                    <h1 class="slide-title">Bienvenue sur <span class="gradient-text">SIS</span></h1>
                    <p class="slide-description">Say It Safely - Le r√©seau social o√π l'anonymat rencontre la libert√© d'expression</p>
                    <div class="slide-illustration">
                        <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                            <defs>
                                <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
                                    <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
                                </linearGradient>
                            </defs>
                            <circle cx="100" cy="100" r="80" fill="url(#grad1)" opacity="0.2"/>
                            <path d="M 60 80 Q 100 55, 140 80" stroke="url(#grad1)" stroke-width="6" fill="none" stroke-linecap="round"/>
                            <circle cx="70" cy="90" r="5" fill="url(#grad1)"/>
                            <circle cx="130" cy="90" r="5" fill="url(#grad1)"/>
                            <path d="M 60 130 Q 100 150, 140 130" stroke="url(#grad1)" stroke-width="6" fill="none" stroke-linecap="round"/>
                        </svg>
                    </div>
                </div>
            </div>

            <!-- Slide 2 - Messages Anonymes -->
            <div class="onboarding-slide" data-slide="1">
                <div class="slide-content">
                    <div class="slide-icon">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M22 2L11 13" stroke="currentColor" stroke-width="2"/>
                            <path d="M22 2L15 22L11 13L2 9L22 2Z" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </div>
                    <h2 class="slide-title">Messages Anonymes</h2>
                    <p class="slide-description">Recevez des messages 100% anonymes. Partagez votre lien unique et d√©couvrez ce que les gens pensent vraiment.</p>
                    <div class="feature-preview">
                        <div class="feature-preview-card">
                            <div class="feature-preview-header">
                                <div class="feature-preview-avatar">
                                    <svg viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
                                        <circle cx="20" cy="20" r="20" fill="#667eea"/>
                                        <text x="20" y="27" font-size="20" fill="white" text-anchor="middle" font-weight="bold">?</text>
                                    </svg>
                                </div>
                                <div class="feature-preview-info">
                                    <div class="feature-preview-name">Quelqu'un d'anonyme</div>
                                    <div class="feature-preview-time">Il y a 2 min</div>
                                </div>
                            </div>
                            <div class="feature-preview-text">Tu es vraiment g√©nial(e) ! Continue comme √ßa üî•‚ú®</div>
                        </div>
                        <div class="feature-preview-card" style="margin-top: 10px;">
                            <div class="feature-preview-header">
                                <div class="feature-preview-avatar">
                                    <svg viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
                                        <circle cx="20" cy="20" r="20" fill="#764ba2"/>
                                        <text x="20" y="27" font-size="20" fill="white" text-anchor="middle" font-weight="bold">?</text>
                                    </svg>
                                </div>
                                <div class="feature-preview-info">
                                    <div class="feature-preview-name">Anonyme</div>
                                    <div class="feature-preview-time">Il y a 5 min</div>
                                </div>
                            </div>
                            <div class="feature-preview-text">J'adore ton style ! üíú</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 3 - Feed Social -->
            <div class="onboarding-slide" data-slide="2">
                <div class="slide-content">
                    <div class="slide-icon">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
                            <path d="M3 9H21" stroke="currentColor" stroke-width="2"/>
                            <path d="M9 21V9" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </div>
                    <h2 class="slide-title">Feed Social</h2>
                    <p class="slide-description">Partagez vos moments, exprimez-vous librement et d√©couvrez du contenu authentique.</p>
                    <div class="feature-preview">
                        <div class="feature-preview-post">
                            <div class="feature-preview-post-header">
                                <div class="feature-preview-avatar">
                                    <svg viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
                                        <circle cx="20" cy="20" r="20" fill="#764ba2"/>
                                        <text x="20" y="26" font-size="16" fill="white" text-anchor="middle" font-weight="bold">S</text>
                                    </svg>
                                </div>
                                <div class="feature-preview-info">
                                    <div class="feature-preview-name">@Odile</div>
                                    <div class="feature-preview-time">Il y a 17h</div>
                                </div>
                            </div>
                            <div class="feature-preview-post-content">
                                <p>Premi√®re publication sur SIS ! J'adore pouvoir m'exprimer librement üéâüíú</p>
                            </div>
                            <div class="feature-preview-post-image">
                                <svg viewBox="0 0 300 160" xmlns="http://www.w3.org/2000/svg">
                                    <defs>
                                        <linearGradient id="postGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                            <stop offset="0%" style="stop-color:#667eea;stop-opacity:0.9" />
                                            <stop offset="100%" style="stop-color:#764ba2;stop-opacity:0.9" />
                                        </linearGradient>
                                    </defs>
                                    <rect width="300" height="160" fill="url(#postGrad)"/>
                                    <circle cx="150" cy="60" r="25" fill="rgba(255,255,255,0.3)"/>
                                    <path d="M 120 90 Q 150 75, 180 90" stroke="rgba(255,255,255,0.5)" stroke-width="4" fill="none" stroke-linecap="round"/>
                                    <text x="150" y="130" font-size="14" fill="white" text-anchor="middle" font-weight="600">SIS Community</text>
                                </svg>
                            </div>
                            <div class="feature-preview-post-actions">
                                <span>‚ù§Ô∏è 247</span>
                                <span>üí¨ 18</span>
                                <span>üîó 5</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 4 - S√©curit√© -->
            <div class="onboarding-slide" data-slide="3">
                <div class="slide-content">
                    <div class="slide-icon">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 22C12 22 20 18 20 12V5L12 2L4 5V12C4 18 12 22 12 22Z" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </div>
                    <h2 class="slide-title">100% S√©curis√©</h2>
                    <p class="slide-description">Vos donn√©es sont prot√©g√©es. Nous ne vendons jamais vos informations et respectons votre vie priv√©e.</p>
                    <div class="feature-list">
                        <div class="feature-list-item">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M22 11.08V12C21.9988 14.1564 21.3005 16.2547 20.0093 17.9818C18.7182 19.7088 16.9033 20.9725 14.8354 21.5839C12.7674 22.1953 10.5573 22.1219 8.53447 21.3746C6.51168 20.6273 4.78465 19.2461 3.61096 17.4371C2.43727 15.628 1.87979 13.4881 2.02168 11.3363C2.16356 9.18455 2.99721 7.13631 4.39828 5.49706C5.79935 3.85781 7.69279 2.71537 9.79619 2.24013C11.8996 1.7649 14.1003 1.98232 16.07 2.85999" stroke="currentColor" stroke-width="2"/>
                                <path d="M22 4L12 14.01L9 11.01" stroke="currentColor" stroke-width="2"/>
                            </svg>
                            <span>Anonymat garanti √† 100%</span>
                        </div>
                        <div class="feature-list-item">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M22 11.08V12C21.9988 14.1564 21.3005 16.2547 20.0093 17.9818C18.7182 19.7088 16.9033 20.9725 14.8354 21.5839C12.7674 22.1953 10.5573 22.1219 8.53447 21.3746C6.51168 20.6273 4.78465 19.2461 3.61096 17.4371C2.43727 15.628 1.87979 13.4881 2.02168 11.3363C2.16356 9.18455 2.99721 7.13631 4.39828 5.49706C5.79935 3.85781 7.69279 2.71537 9.79619 2.24013C11.8996 1.7649 14.1003 1.98232 16.07 2.85999" stroke="currentColor" stroke-width="2"/>
                                <path d="M22 4L12 14.01L9 11.01" stroke="currentColor" stroke-width="2"/>
                            </svg>
                            <span>Protection des donn√©es</span>
                        </div>
                        <div class="feature-list-item">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M22 11.08V12C21.9988 14.1564 21.3005 16.2547 20.0093 17.9818C18.7182 19.7088 16.9033 20.9725 14.8354 21.5839C12.7674 22.1953 10.5573 22.1219 8.53447 21.3746C6.51168 20.6273 4.78465 19.2461 3.61096 17.4371C2.43727 15.628 1.87979 13.4881 2.02168 11.3363C2.16356 9.18455 2.99721 7.13631 4.39828 5.49706C5.79935 3.85781 7.69279 2.71537 9.79619 2.24013C11.8996 1.7649 14.1003 1.98232 16.07 2.85999" stroke="currentColor" stroke-width="2"/>
                                <path d="M22 4L12 14.01L9 11.01" stroke="currentColor" stroke-width="2"/>
                            </svg>
                            <span>Aucune publicit√© intrusive</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 5 - Commencer -->
            <div class="onboarding-slide" data-slide="4">
                <div class="slide-content">
                    <div class="slide-icon">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </div>
                    <h2 class="slide-title">Pr√™t √† commencer ?</h2>
                    <p class="slide-description">Rejoignez des milliers d'utilisateurs qui s'expriment librement et en toute s√©curit√© sur SIS</p>
                    <div class="stats-preview">
                        <div class="stat-preview-item">
                            <div class="stat-preview-value">05K+</div>
                            <div class="stat-preview-label">Utilisateurs actifs</div>
                        </div>
                        <div class="stat-preview-item">
                            <div class="stat-preview-value">100K+</div>
                            <div class="stat-preview-label">Messages envoy√©s</div>
                        </div>
                        <div class="stat-preview-item">
                            <div class="stat-preview-value">10K+</div>
                            <div class="stat-preview-label">Publications</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide Indicators -->
        <div class="slide-indicators" id="slideIndicators">
            <span class="indicator active" data-slide="0"></span>
            <span class="indicator" data-slide="1"></span>
            <span class="indicator" data-slide="2"></span>
            <span class="indicator" data-slide="3"></span>
            <span class="indicator" data-slide="4"></span>
        </div>

        <!-- Navigation Buttons -->
        <div class="onboarding-nav">
            <button class="btn-prev" id="prevBtn" style="visibility: hidden;">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M19 12H5M5 12L12 19M5 12L12 5" stroke="currentColor" stroke-width="2"/>
                </svg>
                Pr√©c√©dent
            </button>
            <button class="btn-next" id="nextBtn">
                Suivant
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2"/>
                </svg>
            </button>
            <button class="btn-start" id="startBtn" style="display: none;">
                Commencer
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2"/>
                </svg>
            </button>
        </div>
    </div>

    <!-- Auth Container -->
    <div class="auth-container" id="authContainer">
        <div class="auth-box">
            <div class="auth-logo">
                <img src="https://i.ibb.co/tGCTMvk/logo.png" alt="SIS Logo">
            </div>

            <h1 class="auth-title">SIS</h1>
            <p class="auth-subtitle">Say It Safely</p>

            <div class="auth-tabs">
                <button class="auth-tab active" id="loginTab">Connexion</button>
                <button class="auth-tab" id="registerTab">Inscription</button>
            </div>

            <div id="authError" class="auth-message error-message"></div>
            <div id="authSuccess" class="auth-message success-message"></div>

            <!-- Login Form -->
            <form class="auth-form active" id="loginForm">
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <div class="input-wrapper">
                        <svg class="input-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M20 4H4C2.89543 4 2 4.89543 2 6V18C2 19.1046 2.89543 20 4 20H20C21.1046 20 22 19.1046 22 18V6C22 4.89543 21.1046 4 20 4Z" stroke="currentColor" stroke-width="2"/>
                            <path d="M22 7L13.03 12.7C12.7213 12.8934 12.3643 12.996 12 12.996C11.6357 12.996 11.2787 12.8934 10.97 12.7L2 7" stroke="currentColor" stroke-width="2"/>
                        </svg>
                        <input type="email" class="form-input" id="loginEmail" placeholder="votre@email.com" required autocomplete="email">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Mot de passe</label>
                    <div class="input-wrapper">
                        <svg class="input-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M19 11H5C3.89543 11 3 11.8954 3 13V20C3 21.1046 3.89543 22 5 22H19C20.1046 22 21 21.1046 21 20V13C21 11.8954 20.1046 11 19 11Z" stroke="currentColor" stroke-width="2"/>
                            <path d="M7 11V7C7 5.67392 7.52678 4.40215 8.46447 3.46447C9.40215 2.52678 10.6739 2 12 2C13.3261 2 14.5979 2.52678 15.5355 3.46447C16.4732 4.40215 17 5.67392 17 7V11" stroke="currentColor" stroke-width="2"/>
                        </svg>
                        <input type="password" class="form-input" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required autocomplete="current-password">
                    </div>
                </div>
                <button type="submit" class="btn-submit" id="loginBtn">
                    <span class="btn-text">Se connecter</span>
                    <svg class="btn-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </button>
            </form>

            <!-- Register Form -->
            <form class="auth-form" id="registerForm">
                <div class="form-group">
                    <label class="form-label">Pseudo</label>
                    <div class="input-wrapper">
                        <svg class="input-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21" stroke="currentColor" stroke-width="2"/>
       </svg>
                </button>
            </form>

            <div class="auth-footer">
                <p>En continuant, vous acceptez nos <a href="conditions.html">Conditions</a> et <a href="politiques.html">Politiques</a></p>
            </div>
        </div>
    </div>

    <!-- Main App - Profile Setup -->
    <div class="main-app" id="mainApp">
        <!-- Header -->
        <header class="header">
            <div class="header-inner">
                <div class="header-left">
                    <div class="logo">
                        <img src="https://i.ibb.co/tGCTMvk/logo.png" alt="SIS Logo" class="logo-img">
                        <span class="logo-text">SIS</span>
                    </div>
                </div>

                <nav class="header-center">
                    <button class="nav-icon active" title="Accueil" id="homeNavBtn">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M3 9L12 2L21 9V20C21 20.5304 20.7893 21.0391 20.4142 21.4142C20.0391 21.7893 19.5304 22 19 22H5C4.46957 22 3.96086 21.7893 3.58579 21.4142C3.21071 21.0391 3 20.5304 3 20V9Z" stroke="currentColor" stroke-width="2"/>
                            <path d="M9 22V12H15V22" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </button>
                    <button class="nav-icon" title="Feed Social" id="feedNavBtn">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
                            <path d="M3 9H21" stroke="currentColor" stroke-width="2"/>
                            <path d="M9 21V9" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </button>
                    <button class="nav-icon" title="Mes messages" id="messagesNavBtn">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M21 15C21 15.5304 20.7893 16.0391 20.4142 16.4142C20.0391 16.7893 19.5304 17 19 17H7L3 21V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H19C19.5304 3 20.0391 3.21071 20.4142 3.58579C20.7893 3.96086 21 4.46957 21 5V15Z" stroke="currentColor" stroke-width="2"/>
                        </svg>
                        <span class="nav-badge" id="messagesBadge">0</span>
                    </button>
                </nav>

                <div class="header-right">
                    <button class="header-icon" id="settingsBtn">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
                            <path d="M19.4 15C19.2669 15.3016 19.2272 15.6362 19.286 15.9606C19.3448 16.285 19.4995 16.5843 19.73 16.82L19.79 16.88C19.976 17.0657 20.1235 17.2863 20.2241 17.5291C20.3248 17.7719 20.3766 18.0322 20.3766 18.295C20.3766 18.5578 20.3248 18.8181 20.2241 19.0609C20.1235 19.3037 19.976 19.5243 19.79 19.71C19.6043 19.896 19.3837 20.0435 19.1409 20.1441C18.8981 20.2448 18.6378 20.2966 18.375 20.2966C18.1122 20.2966 17.8519 20.2448 17.6091 20.1441C17.3663 20.0435 17.1457 19.896 16.96 19.71L16.9 19.65C16.6643 19.4195 16.365 19.2648 16.0406 19.206C15.7162 19.1472 15.3816 19.1869 15.08 19.32C14.7842 19.4468 14.532 19.6572 14.3543 19.9255C14.1766 20.1938 14.0813 20.5082 14.08 20.83V21C14.08 21.5304 13.8693 22.0391 13.4942 22.4142C13.1191 22.7893 12.6104 23 12.08 23C11.5496 23 11.0409 22.7893 10.6658 22.4142C10.2907 22.0391 10.08 21.5304 10.08 21V20.91C10.0723 20.579 9.96512 20.258 9.77251 19.9887C9.5799 19.7194 9.31074 19.5143 9 19.4C8.69838 19.2669 8.36381 19.2272 8.03941 19.286C7.71502 19.3448 7.41568 19.4995 7.18 19.73L7.12 19.79C6.93425 19.976 6.71368 20.1235 6.47088 20.2241C6.22808 20.3248 5.96783 20.3766 5.705 20.3766C5.44217 20.3766 5.18192 20.3248 4.93912 20.2241C4.69632 20.1235 4.47575 19.976 4.29 19.79C4.10405 19.6043 3.95653 19.3837 3.85588 19.1409C3.75523 18.8981 3.70343 18.6378 3.70343 18.375C3.70343 18.1122 3.75523 17.8519 3.85588 17.6091C3.95653 17.3663 4.10405 17.1457 4.29 16.96L4.35 16.9C4.58054 16.6643 4.73519 16.365 4.794 16.0406C4.85282 15.7162 4.81312 15.3816 4.68 15.08C4.55324 14.7842 4.34276 14.532 4.07447 14.3543C3.80618 14.1766 3.49179 14.0813 3.17 14.08H3C2.46957 14.08 1.96086 13.8693 1.58579 13.4942C1.21071 13.1191 1 12.6104 1 12.08C1 11.5496 1.21071 11.0409 1.58579 10.6658C1.96086 10.2907 2.46957 10.08 3 10.08H3.09C3.42099 10.0723 3.742 9.96512 4.0113 9.77251C4.28059 9.5799 4.48572 9.31074 4.6 9C4.73312 8.69838 4.77282 8.36381 4.714 8.03941C4.65519 7.71502 4.50054 7.41568 4.27 7.18L4.21 7.12C4.02405 6.93425 3.87653 6.71368 3.77588 6.47088C3.67523 6.22808 3.62343 5.96783 3.62343 5.705C3.62343 5.44217 3.67523 5.18192 3.77588 4.93912C3.87653 4.69632 4.02405 4.47575 4.21 4.29C4.39575 4.10405 4.61632 3.95653 4.85912 3.85588C5.10192 3.75523 5.36217 3.70343 5.625 3.70343C5.88783 3.70343 6.14808 3.75523 6.39088 3.85588C6.63368 3.95653 6.85425 4.10405 7.04 4.29L7.1 4.35C7.33568 4.58054 7.63502 4.73519 7.95941 4.794C8.28381 4.85282 8.61838 4.81312 8.92 4.68H9C9.29577 4.55324 9.54802 4.34276 9.72569 4.07447C9.90337 3.80618 9.99872 3.49179 10 3.17V3C10 2.46957 10.2107 1.96086 10.5858 1.58579C10.9609 1.21071 11.4696 1 12 1C12.5304 1 13.0391 1.21071 13.4142 1.58579C13.7893 1.96086 14 2.46957 14 3V3.09C14.0013 3.41179 14.0966 3.72618 14.2743 3.99447C14.452 4.26276 14.7042 4.47324 15 4.6C15.3016 4.73312 15.6362 4.77282 15.9606 4.714C16.285 4.65519 16.5843 4.50054 16.82 4.27L16.88 4.21C17.0657 4.02405 17.2863 3.87653 17.5291 3.77588C17.7719 3.67523 18.0322 3.62343 18.295 3.62343C18.5578 3.62343 18.8181 3.67523 19.0609 3.77588C19.3037 3.87653 19.5243 4.02405 19.71 4.21C19.896 4.39575 20.0435 4.61632 20.1441 4.85912C20.2448 5.10192 20.2966 5.36217 20.2966 5.625C20.2966 5.88783 20.2448 6.14808 20.1441 6.39088C20.0435 6.63368 19.896 6.85425 19.71 7.04L19.65 7.1C19.4195 7.33568 19.2648 7.63502 19.206 7.95941C19.1472 8.28381 19.1869 8.61838 19.32 8.92V9C19.4468 9.29577 19.6572 9.54802 19.9255 9.72569C20.1938 9.90337 20.5082 9.99872 20.83 10H21C21.5304 10 22.0391 10.2107 22.4142 10.5858C22.7893 10.9609 23 11.4696 23 12C23 12.5304 22.7893 13.0391 22.4142 13.4142C22.0391 13.7893 21.5304 14 21 14H20.91C20.5882 14.0013 20.2738 14.0966 20.0055 14.2743C19.7372 14.452 19.5268 14.7042 19.4 15Z" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </button>
                    <img src="https://ui-avatars.com/api/?name=User&background=667eea&color=fff&size=128" alt="User" class="user-avatar-header" id="userAvatarHeader">
                </div>
            </div>
        </header>

        <!-- Profile Setup Container -->
        <div class="profile-setup-container" id="profileSetupContainer">
            <div class="setup-card">
                <div class="setup-progress">
                    <div class="progress-step active" data-step="1">
                        <div class="step-number">1</div>
                        <div class="step-label">Photo</div>
                    </div>
                    <div class="progress-line"></div>
                    <div class="progress-step" data-step="2">
                        <div class="step-number">2</div>
                        <div class="step-label">Lien</div>
                    </div>
                    <div class="progress-line"></div>
                    <div class="progress-step" data-step="3">
                        <div class="step-number">3</div>
                        <div class="step-label">Partage</div>
                    </div>
                </div>

                <!-- Step 1: Photo de profil -->
                <div class="setup-step active" id="step1">
                    <h2 class="setup-title">Choisissez votre photo de profil</h2>
                    <p class="setup-description">Cette photo sera visible par les personnes qui vous envoient des messages</p>
                    
                    <div class="avatar-upload-section">
                        <div class="avatar-preview" id="avatarPreview">
                            <img src="https://ui-avatars.com/api/?name=User&background=667eea&color=fff&size=200" alt="Avatar" id="avatarImage">
                            <div class="avatar-overlay">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M23 19C23 19.5304 22.7893 20.0391 22.4142 20.4142C22.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V8C3 7.46957 3.21071 6.96086 3.58579 6.58579C3.96086 6.21071 4.46957 6 5 6H7L9 4H15L17 6H19C19.5304 6 20.0391 6.21071 20.4142 6.58579C20.7893 6.96086 21 7.46957 21 8V19Z" stroke="currentColor" stroke-width="2"/>
                                    <circle cx="12" cy="13" r="3" stroke="currentColor" stroke-width="2"/>
                                </svg>
                            </div>
                        </div>
                        <button class="btn-upload" onclick="document.getElementById('photoInput').click()">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15" stroke="currentColor" stroke-width="2"/>
                                <path d="M17 8L12 3L7 8" stroke="currentColor" stroke-width="2"/>
                                <path d="M12 3V15" stroke="currentColor" stroke-width="2"/>
                            </svg>
                            Choisir une photo
                        </button>
                        <input type="file" id="photoInput" accept="image/*" style="display: none;">
                        <p class="upload-hint">JPG, PNG ou GIF - Maximum 5MB</p>
                    </div>

                    <div class="upload-progress" id="uploadProgress" style="display: none;">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <div class="progress-text" id="progressText">Upload en cours...</div>
                    </div>

                    <div class="setup-actions">
                        <button class="btn-skip" id="skipPhotoBtn">Passer cette √©tape</button>
                        <button class="btn-continue" id="continueStep1">
                            Continuer
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Step 2: Votre lien unique -->
                <div class="setup-step" id="step2">
                    <h2 class="setup-title">Votre lien anonyme est pr√™t ! üéâ</h2>
                    <p class="setup-description">Partagez ce lien pour recevoir des messages anonymes</p>
                    
                    <div class="link-card">
                        <div class="link-card-header">
                            <img src="https://i.ibb.co/tGCTMvk/logo.png" alt="SIS" class="link-card-logo">
                            <div class="link-card-info">
                                <div class="link-card-title">Votre lien SIS</div>
                                <div class="link-card-subtitle" id="userPseudoDisplay">@username</div>
                            </div>
                        </div>
                        <div class="link-display" id="userLinkDisplay">
                            https://sis-send.vercel.app/index.html?to=username
                        </div>
                        <button class="btn-copy" id="copyLinkBtn">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                                <path d="M5 15H4C3.46957 15 2.96086 14.7893 2.58579 14.4142C2.21071 14.0391 2 13.5304 2 13V4C2 3.46957 2.21071 2.96086 2.58579 2.58579C2.96086 2.21071 3.46957 2 4 2H13C13.5304 2 14.0391 2.21071 14.4142 2.58579C14.7893 2.96086 15 3.46957 15 4V5" stroke="currentColor" stroke-width="2"/>
                            </svg>
                            Copier le lien
                        </button>
                    </div>

                    <div class="link-stats">
                        <div class="link-stat-item">
                            <div class="link-stat-icon">üì¨</div>
                            <div class="link-stat-value" id="linkMessages">0</div>
                            <div class="link-stat-label">Messages re√ßus</div>
                        </div>
                        <div class="link-stat-item">
                            <div class="link-stat-icon">üëÅÔ∏è</div>
                            <div class="link-stat-value" id="linkViews">0</div>
                            <div class="link-stat-label">Vues du lien</div>
                        </div>
                    </div>

                    <div class="setup-actions">
                        <button class="btn-back" id="backStep2">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M19 12H5M5 12L12 19M5 12L12 5" stroke="currentColor" stroke-width="2"/>
                            </svg>
                            Retour
                        </button>
                        <button class="btn-continue" id="continueStep2">
                            Partager mon lien
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Step 3: Partage sur les r√©seaux -->
                <div class="setup-step" id="step3">
                    <h2 class="setup-title">Partagez votre lien ! üöÄ</h2>
                    <p class="setup-description">Choisissez o√π partager votre lien pour commencer √† recevoir des messages</p>
                    
                    <div class="share-section">
                        <h3 class="share-section-title">R√©seaux sociaux</h3>
                        <div class="share-grid">
                            <button class="share-card" id="shareWhatsApp">
                                <div class="share-card-icon whatsapp">
                                    <svg viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
                                    </svg>
                                </div>
                                <div class="share-card-name">WhatsApp</div>
                            </button>

                            <button class="share-card" id="shareInstagram">
                                <div class="share-card-icon instagram">
                                    <svg viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                                    </svg>
                                </div>
                                <div class="share-card-name">Instagram</div>
                            </button>

                            <button class="share-card" id="shareSnapchat">
                                <div class="share-card-icon snapchat">
                                    <svg viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M5.829 4.533c-.6 1.344-.363 3.752-.267 5.436-.648.359-1.48-.271-1.951-.271-.49 0-1.075.322-1.167.802-.066.346.089.85 1.201 1.289.43.17 1.453.37 1.69.928.333.784-1.71 4.403-4.918 4.931-.251.041-.43.265-.416.519.056.975 2.242 1.357 3.211 1.507.099.134.179.7.306 1.131.057.193.204.424.582.424.493 0 1.312-.38 2.738-.144 1.398.233 2.712 2.215 5.235 2.215 2.345 0 3.744-1.991 5.09-2.215.779-.129 1.448-.088 2.196.058.515.101.977.157 1.124-.349.129-.437.208-.992.305-1.123.96-.149 3.156-.53 3.211-1.505.014-.254-.165-.477-.416-.519-3.154-.52-5.259-4.128-4.918-4.931.236-.557 1.252-.755 1.69-.928.814-.321 1.222-.716 1.213-1.173-.011-.585-.715-.934-1.233-.934-.527 0-1.284.624-1.897.286.096-1.698.332-4.095-.267-5.438-1.135-2.544-3.66-3.829-6.184-3.829-2.508 0-5.014 1.268-6.158 3.833z"/>
                                    </svg>
                                </div>
                                <div class="share-card-name">Snapchat</div>
                            </button>

                            <button class="share-card" id="shareTikTok">
                                <div class="share-card-icon tiktok">
                                    <svg viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M19.59 6.69a4.83 4.83 0 01-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 01-5.2 1.74 2.89 2.89 0 012.31-4.64 2.93 2.93 0 01.88.13V9.4a6.84 6.84 0 00-1-.05A6.33 6.33 0 005 20.1a6.34 6.34 0 0010.86-4.43v-7a8.16 8.16 0 004.77 1.52v-3.4a4.85 4.85 0 01-1-.1z"/>
                                    </svg>
                                </div>
                                <div class="share-card-name">TikTok</div>
                            </button>

                            <button class="share-card" id="shareFacebook">
                                <div class="share-card-icon facebook">
                                    <svg viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                                    </svg>
                                </div>
                                <div class="share-card-name">Facebook</div>
                            </button>

                            <button class="share-card" id="shareTwitter">
                                <div class="share-card-icon twitter">
                                    <svg viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0  
024 4.59z"/>
                                    </svg>
                                </div>
                                <div class="share-card-name">Twitter</div>
                            </button>

                            <button class="share-card" id="shareTelegram">
                                <div class="share-card-icon telegram">
                                    <svg viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
                                    </svg>
                                </div>
                                <div class="share-card-name">Telegram</div>
                            </button>

                            <button class="share-card" id="shareMore">
                                <div class="share-card-icon more">
                                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <circle cx="12" cy="5" r="2" stroke="currentColor" stroke-width="2"/>
                                        <circle cx="12" cy="12" r="2" stroke="currentColor" stroke-width="2"/>
                                        <circle cx="12" cy="19" r="2" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                </div>
                                <div class="share-card-name">Plus</div>
                            </button>
                        </div>

                        <div class="share-tip">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                                <path d="M12 16V12" stroke="currentColor" stroke-width="2"/>
                                <path d="M12 8H12.01" stroke="currentColor" stroke-width="2"/>
                            </svg>
                            <p>Astuce : Plus vous partagez votre lien, plus vous recevrez de messages anonymes !</p>
                        </div>
                    </div>

                    <div class="setup-actions">
                        <button class="btn-back" id="backStep3">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M19 12H5M5 12L12 19M5 12L12 5" stroke="currentColor" stroke-width="2"/>
                            </svg>
                            Retour
                        </button>
                        <button class="btn-finish" id="finishBtn">
                            Terminer la configuration
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M22 11.08V12C21.9988 14.1564 21.3005 16.2547 20.0093 17.9818C18.7182 19.7088 16.9033 20.9725 14.8354 21.5839C12.7674 22.1953 10.5573 22.1219 8.53447 21.3746C6.51168 20.6273 4.78465 19.2461 3.61096 17.4371C2.43727 15.628 1.87979 13.4881 2.02168 11.3363C2.16356 9.18455 2.99721 7.13631 4.39828 5.49706C5.79935 3.85781 7.69279 2.71537 9.79619 2.24013C11.8996 1.7649 14.1003 1.98232 16.07 2.85999" stroke="currentColor" stroke-width="2"/>
                                <path d="M22 4L12 14.01L9 11.01" stroke="currentColor" stroke-width="2"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Home Content (Affich√© apr√®s setup) -->
        <div class="home-content" id="homeContent" style="display: none;">
            <div class="home-container">
                <div class="home-welcome">
                    <h1 class="home-title">Bienvenue sur SIS üëã</h1>
                    <p class="home-subtitle">Votre espace pour vous exprimer librement et recevoir des messages anonymes</p>
                </div>

                <div class="home-quick-actions">
                    <button class="quick-action-card" id="viewMessagesBtn">
                        <div class="quick-action-icon">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M21 15C21 15.5304 20.7893 16.0391 20.4142 16.4142C20.0391 16.7893 19.5304 17 19 17H7L3 21V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H19C19.5304 3 20.0391 3.21071 20.4142 3.58579C20.7893 3.96086 21 4.46957 21 5V15Z" stroke="currentColor" stroke-width="2"/>
                            </svg>
                        </div>
                        <div class="quick-action-info">
                            <h3 class="quick-action-title">Mes Messages</h3>
                            <p class="quick-action-desc">Voir les messages re√ßus</p>
                        </div>
                        <span class="quick-action-badge" id="homeMessagesBadge">0</span>
                    </button>

                    <button class="quick-action-card" id="shareLinkBtn">
                        <div class="quick-action-icon">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M22 2L11 13" stroke="currentColor" stroke-width="2"/>
                                <path d="M22 2L15 22L11 13L2 9L22 2Z" stroke="currentColor" stroke-width="2"/>
                            </svg>
                        </div>
                        <div class="quick-action-info">
                            <h3 class="quick-action-title">Partager mon lien</h3>
                            <p class="quick-action-desc">Recevoir des messages</p>
                        </div>
                    </button>

                    <button class="quick-action-card" id="viewFeedBtn">
                        <div class="quick-action-icon">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
                                <path d="M3 9H21" stroke="currentColor" stroke-width="2"/>
                                <path d="M9 21V9" stroke="currentColor" stroke-width="2"/>
                            </svg>
                        </div>
                        <div class="quick-action-info">
                            <h3 class="quick-action-title">Feed Social</h3>
                            <p class="quick-action-desc">D√©couvrir les publications</p>
                        </div>
                    </button>
                </div>

                <div class="home-stats-card">
                    <h2 class="stats-card-title">Vos statistiques</h2>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-icon">üì¨</div>
                            <div class="stat-value" id="homeStatsMessages">0</div>
                            <div class="stat-label">Messages</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-icon">üëÅÔ∏è</div>
                            <div class="stat-value" id="homeStatsViews">0</div>
                            <div class="stat-label">Vues</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-icon">üîó</div>
                            <div class="stat-value">1</div>
                            <div class="stat-label">Lien actif</div>
                        </div>
                    </div>
                </div>

                <div class="home-link-card">
                    <h2 class="link-card-title">Votre lien anonyme</h2>
                    <div class="link-display-home" id="homeLinkDisplay">
                        https://sis-send.vercel.app/index.html?to=username
                    </div>
                    <button class="btn-copy-home" id="copyLinkHomeBtn">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                            <path d="M5 15H4C3.46957 15 2.96086 14.7893 2.58579 14.4142C2.21071 14.0391 2 13.5304 2 13V4C2 3.46957 2.21071 2.96086 2.58579 2.58579C2.96086 2.21071 3.46957 2 4 2H13C13.5304 2 14.0391 2.21071 14.4142 2.58579C14.7893 2.96086 15 3.46957 15 4V5" stroke="currentColor" stroke-width="2"/>
                        </svg>
                        Copier le lien
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Param√®tres</h2>
                <button class="modal-close" id="closeSettingsModal">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h3 class="settings-section-title">Navigation</h3>
                    <div class="settings-item clickable" id="settingsViewMessages">
                        <div class="settings-item-info">
                            <svg class="settings-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M21 15C21 15.5304 20.7893 16.0391 20.4142 16.4142C20.0391 16.7893 19.5304 17 19 17H7L3 21V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H19C19.5304 3 20.0391 3.21071 20.4142 3.58579C20.7893 3.96086 21 4.46957 21 5V15Z" stroke="currentColor" stroke-width="2"/>
                            </svg>
                            <div>
                                <div class="settings-item-title">Mes messages</div>
                                <div class="settings-item-desc">Messages anonymes re√ßus</div>
                            </div>
                        </div>
                        <svg class="settings-arrow" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </div>
                    <div class="settings-item clickable" id="settingsShareLink">
                        <div class="settings-item-info">
                            <svg class="settings-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M22 2L11 13" stroke="currentColor" stroke-width="2"/>
                                <path d="M22 2L15 22L11 13L2 9L22 2Z" stroke="currentColor" stroke-width="2"/>
                            </svg>
                            <div>
                                <div class="settings-item-title">Partager mon lien</div>
                                <div class="settings-item-desc">Recevoir des messages</div>
                            </div>
                        </div>
                        <svg class="settings-arrow" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </div>
                </div>

                <div class="settings-section">
                    <h3 class="settings-section-title">Compte</h3>
                    <div class="settings-item clickable" onclick="window.location.href='conditions.html'">
                        <div class="settings-item-info">
                            <svg class="settings-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z" stroke="currentColor" stroke-width="2"/>
                                <path d="M14 2V8H20" stroke="currentColor" stroke-width="2"/>
                            </svg>
                            <div>
                                <div class="settings-item-title">Conditions d'utilisation</div>
                                <div class="settings-item-desc">Lire les conditions</div>
                            </div>
                        </div>
                        <svg class="settings-arrow" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </div>
                    <div class="settings-item clickable" onclick="window.location.href='politiques.html'">
                        <div class="settings-item-info">
                            <svg class="settings-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 22C12 22 20 18 20 12V5L12 2L4 5V12C4 18 12 22 12 22Z" stroke="currentColor" stroke-width="2"/>
                            </svg>
                            <div>
                                <div class="settings-item-title">Politique de confidentialit√©</div>
                                <div class="settings-item-desc">Protection des donn√©es</div>
                            </div>
                        </div>
                        <svg class="settings-arrow" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </div>
                    <div class="settings-item clickable danger" id="logoutBtnModal">
                        <div class="settings-item-info">
                            <svg class="settings-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M9 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H9" stroke="currentColor" stroke-width="2"/>
                                <path d="M16 17L21 12L16 7" stroke="currentColor" stroke-width="2"/>
                                <path d="M21 12H9" stroke="currentColor" stroke-width="2"/>
                            </svg>
                            <div>
                                <div class="settings-item-title">D√©connexion</div>
                                <div class="settings-item-desc">Se d√©connecter</div>
                            </div>
                        </div>
                        <svg class="settings-arrow" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <svg class="toast-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M22 11.08V12C21.9988 14.1564 21.3005 16.2547 20.0093 17.9818C18.7182 19.7088 16.9033 20.9725 14.8354 21.5839C12.7674 22.1953 10.5573 22.1219 8.53447 21.3746C6.51168 20.6273 4.78465 19.2461 3.61096 17.4371C2.43727 15.628 1.87979 13.4881 2.02168 11.3363C2.16356 9.18455 2.99721 7.13631 4.39828 5.49706C5.79935 3.85781 7.69279 2.71537 9.79619 2.24013C11.8996 1.7649 14.1003 1.98232 16.07 2.85999" stroke="currentColor" stroke-width="2"/>
            <path d="M22 4L12 14.01L9 11.01" stroke="currentColor" stroke-width="2"/>
        </svg>
        <span class="toast-message" id="toastMessage">Action r√©ussie !</span>
    </div>

    <!-- CSS Styles -->
    <style>
        /* TON CSS ICI (celui que je t'ai donn√© pr√©c√©demment) */
/* ============================================
   VARIABLES & RESET
   ============================================ */
:root {
    --primary-gradient: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
    --primary-color: #667eea;
    --primary-dark: #5a67d8;
    --secondary-color: #764ba2;
    --accent-color: #f093fb;
    
    --bg-primary: #ffffff;
    --bg-secondary: #f7fafc;
    --bg-tertiary: #edf2f7;
    
    --text-primary: #1a202c;
    --text-secondary: #4a5568;
    --text-tertiary: #718096;
    
    --border-color: #e2e8f0;
    --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
    --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
    --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
    --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.15);
    
    --radius-sm: 8px;
    --radius-md: 12px;
    --radius-lg: 16px;
    --radius-xl: 24px;
    
    --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    background: var(--bg-secondary);
    color: var(--text-primary);
    line-height: 1.6;
    overflow-x: hidden;
}

button {
    font-family: inherit;
    cursor: pointer;
    border: none;
    outline: none;
}

input, textarea {
    font-family: inherit;
    outline: none;
}

a {
    text-decoration: none;
    color: inherit;
}

/* ============================================
   LOADER SCREEN
   ============================================ */
.loader-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    background: var(--primary-gradient);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    transition: opacity 0.5s, visibility 0.5s;
}

.loader-screen.hidden {
    opacity: 0;
    visibility: hidden;
}

.loader-container {
    text-align: center;
}

.loader-logo {
    width: 80px;
    height: 80px;
    margin-bottom: 20px;
    animation: float 3s ease-in-out infinite;
}

@keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-20px); }
}

.loader-spinner {
    width: 50px;
    height: 50px;
    margin: 0 auto 20px;
    border: 4px solid rgba(255, 255, 255, 0.3);
    border-top-color: white;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

.loader-text {
    color: white;
    font-size: 16px;
    font-weight: 500;
}

/* ============================================
   ONBOARDING SCREEN
   ============================================ */
.onboarding-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    background: var(--primary-gradient);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    padding: 20px;
    transition: opacity 0.5s, visibility 0.5s;
}

.onboarding-screen.hidden {
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
}

.skip-btn {
    position: absolute;
    top: 20px;
    right: 20px;
    background: rgba(255, 255, 255, 0.2);
    color: white;
    padding: 10px 20px;
    border-radius: var(--radius-lg);
    font-weight: 500;
    backdrop-filter: blur(10px);
    transition: var(--transition);
}

.skip-btn:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: translateY(-2px);
}

.onboarding-slides {
    width: 100%;
    max-width: 500px;
    height: 70vh;
    position: relative;
    overflow: hidden;
}

.onboarding-slide {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    transform: translateX(100%);
    transition: all 0.5s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.onboarding-slide.active {
    opacity: 1;
    transform: translateX(0);
}

.onboarding-slide.prev {
    transform: translateX(-100%);
}

.slide-content {
    text-align: center;
    color: white;
    padding: 20px;
}

.slide-logo {
    width: 100px;
    height: 100px;
    margin: 0 auto 20px;
}

.slide-icon {
    width: 80px;
    height: 80px;
    margin: 0 auto 20px;
    color: white;
}

.slide-title {
    font-size: 28px;
    font-weight: 700;
    margin-bottom: 15px;
}

.gradient-text {
    background: linear-gradient(to right, #fff, #f0f0f0);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.slide-description {
    font-size: 16px;
    opacity: 0.9;
    margin-bottom: 30px;
    line-height: 1.6;
}

.slide-illustration {
    width: 200px;
    height: 200px;
    margin: 30px auto;
}

/* Feature Preview Cards */
.feature-preview {
    margin-top: 30px;
}

.feature-preview-card {
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(10px);
    border-radius: var(--radius-lg);
    padding: 15px;
    margin-bottom: 10px;
}

.feature-preview-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 10px;
}

.feature-preview-avatar {
    width: 40px;
    height: 40px;
    flex-shrink: 0;
}

.feature-preview-info {
    flex: 1;
}

.feature-preview-name {
    font-weight: 600;
    font-size: 14px;
}

.feature-preview-time {
    font-size: 12px;
    opacity: 0.8;
}

.feature-preview-text {
    font-size: 14px;
    line-height: 1.5;
}

/* Feature Preview Post */
.feature-preview-post {
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(10px);
    border-radius: var(--radius-lg);
    padding: 15px;
}

.feature-preview-post-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 12px;
}

.feature-preview-post-content {
    margin-bottom: 12px;
    font-size: 14px;
}

.feature-preview-post-image {
    border-radius: var(--radius-md);
    overflow: hidden;
    margin-bottom: 12px;
}

.feature-preview-post-actions {
    display: flex;
    gap: 20px;
    font-size: 14px;
}

/* Feature List */
.feature-list {
    margin-top: 30px;
}

.feature-list-item {
    display: flex;
    align-items: center;
    gap: 15px;
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(10px);
    padding: 15px;
    border-radius: var(--radius-lg);
    margin-bottom: 12px;
}

.feature-list-item svg {
    width: 24px;
    height: 24px;
    flex-shrink: 0;
    color: white;
}

.feature-list-item span {
    font-size: 15px;
}

/* Stats Preview */
.stats-preview {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 15px;
    margin-top: 30px;
}

.stat-preview-item {
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(10px);
    padding: 20px;
    border-radius: var(--radius-lg);
    text-align: center;
}

.stat-preview-value {
    font-size: 24px;
    font-weight: 700;
    margin-bottom: 5px;
}

.stat-preview-label {
    font-size: 12px;
    opacity: 0.9;
}

/* Slide Indicators */
.slide-indicators {
    display: flex;
    gap: 8px;
    justify-content: center;
    margin: 30px 0;
}

.indicator {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.4);
    cursor: pointer;
    transition: var(--transition);
}

.indicator.active {
    width: 24px;
    border-radius: 4px;
    background: white;
}

/* Onboarding Navigation */
.onboarding-nav {
    display: flex;
    gap: 15px;
    justify-content: center;
    margin-top: 20px;
}

.btn-prev, .btn-next, .btn-start {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 12px 24px;
    border-radius: var(--radius-lg);
    font-weight: 600;
    transition: var(--transition);
}

.btn-prev {
    background: rgba(255, 255, 255, 0.2);
    color: white;
}

.btn-prev:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: translateX(-3px);
}

.btn-next, .btn-start {
    background: white;
    color: var(--primary-color);
}

.btn-next:hover, .btn-start:hover {
    transform: translateX(3px);
    box-shadow: var(--shadow-lg);
}

.btn-prev svg, .btn-next svg, .btn-start svg {
    width: 20px;
    height: 20px;
}

/* ============================================
   AUTH CONTAINER
   ============================================ */
.auth-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    background: var(--primary-gradient);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    z-index: 9998;
    transition: opacity 0.5s, visibility 0.5s;
}

.auth-container.hidden {
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
}

.auth-box {
    background: white;
    border-radius: var(--radius-xl);
    padding: 40px;
    width: 100%;
    max-width: 440px;
    box-shadow: var(--shadow-xl);
    animation: slideUp 0.5s ease;
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.auth-logo {
    text-align: center;
    margin-bottom: 20px;
}

.auth-logo img {
    width: 80px;
    height: 80px;
}

.auth-title {
    text-align: center;
    font-size: 32px;
    font-weight: 700;
    background: var(--primary-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 5px;
}

.auth-subtitle {
    text-align: center;
    color: var(--text-secondary);
    margin-bottom: 30px;
    font-size: 14px;
}

.auth-tabs {
    display: flex;
    gap: 10px;
    margin-bottom: 25px;
    background: var(--bg-secondary);
    padding: 5px;
    border-radius: var(--radius-lg);
}

.auth-tab {
    flex: 1;
    padding: 12px;
    background: transparent;
    color: var(--text-secondary);
    border-radius: var(--radius-md);
    font-weight: 600;
    transition: var(--transition);
}

.auth-tab.active {
    background: white;
    color: var(--primary-color);
    box-shadow: var(--shadow-sm);
}

.auth-message {
    padding: 12px;
    border-radius: var(--radius-md);
    margin-bottom: 20px;
    font-size: 14px;
    display: none;
}

.auth-message.show {
    display: block;
}

.error-message {
    background: #fee;
    color: #c33;
    border: 1px solid #fcc;
}

.success-message {
    background: #efe;
    color: #3c3;
    border: 1px solid #cfc;
}

.auth-form {
    display: none;
}

.auth-form.active {
    display: block;
}

.form-group {
    margin-bottom: 20px;
}

.form-label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    font-size: 14px;
    color: var(--text-primary);
}

.input-wrapper {
    position: relative;
}

.input-icon {
    position: absolute;
    left: 15px;
    top: 50%;
    transform: translateY(-50%);
    width: 20px;
    height: 20px;
    color: var(--text-tertiary);
    pointer-events: none;
}

.form-input {
    width: 100%;
    padding: 14px 15px 14px 45px;
    border: 2px solid var(--border-color);
    border-radius: var(--radius-md);
    font-size: 15px;
    transition: var(--transition);
}

.form-input:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.btn-submit {
    width: 100%;
    padding: 14px;
    background: var(--primary-gradient);
    color: white;
    border-radius: var(--radius-md);
    font-weight: 600;
    font-size: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: var(--transition);
    margin-top: 25px;
}

.btn-submit:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
}

.btn-submit:active {
    transform: translateY(0);
}

.btn-submit.loading {
    opacity: 0.7;
    pointer-events: none;
}

.btn-icon {
    width: 20px;
    height: 20px;
}

.auth-footer {
    text-align: center;
    margin-top: 20px;
    font-size: 13px;
    color: var(--text-secondary);
}

.auth-footer a {
    color: var(--primary-color);
    font-weight: 600;
}

.auth-footer a:hover {
    text-decoration: underline;
}

/* ============================================
   MAIN APP
   ============================================ */
.main-app {
    display: none;
    min-height: 100vh;
}

.main-app.active {
    display: block;
}

/* Header */
.header {
    background: white;
    border-bottom: 1px solid var(--border-color);
    position: sticky;
    top: 0;
    z-index: 100;
    box-shadow: var(--shadow-sm);
}

.header-inner {
    max-width: 1200px;
    margin: 0 auto;
    padding: 15px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.header-left {
    flex-shrink: 0;
}

.logo {
    display: flex;
    align-items: center;
    gap: 10px;
}

.logo-img {
    width: 40px;
    height: 40px;
}

.logo-text {
    font-size: 24px;
    font-weight: 700;
    background: var(--primary-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.header-center {
    display: flex;
    gap: 5px;
}

.nav-icon {
    position: relative;
    width: 48px;
    height: 48px;
    background: transparent;
    color: var(--text-tertiary);
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: var(--transition);
}

.nav-icon svg {
    width: 24px;
    height: 24px;
}

.nav-icon:hover {
    background: var(--bg-secondary);
    color: var(--primary-color);
}

.nav-icon.active {
    background: var(--primary-gradient);
    color: white;
}

.nav-badge {
    position: absolute;
    top: 8px;
    right: 8px;
    background: #ef4444;
    color: white;
    font-size: 11px;
    font-weight: 700;
    padding: 2px 6px;
    border-radius: 10px;
    min-width: 18px;
    text-align: center;
}

.header-right {
    display: flex;
    align-items: center;
    gap: 10px;
}

.header-icon {
    width: 40px;
    height: 40px;
    background: transparent;
    color: var(--text-tertiary);
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: var(--transition);
}

.header-icon svg {
    width: 22px;
    height: 22px;
}

.header-icon:hover {
    background: var(--bg-secondary);
    color: var(--primary-color);
}

.user-avatar-header {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    border: 2px solid var(--border-color);
    transition: var(--transition);
}

.user-avatar-header:hover {
    border-color: var(--primary-color);
    transform: scale(1.05);
}

/* ============================================
   PROFILE SETUP CONTAINER
   ============================================ */
.profile-setup-container {
    max-width: 800px;
    margin: 40px auto;
    padding: 20px;
}

.setup-card {
    background: white;
    border-radius: var(--radius-xl);
    padding: 40px;
    box-shadow: var(--shadow-md);
}

.setup-progress {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 40px;
}

.progress-step {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
}

.step-number {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: var(--bg-secondary);
    color: var(--text-tertiary);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    transition: var(--transition);
}

.progress-step.active .step-number {
    background: var(--primary-gradient);
    color: white;
    transform: scale(1.1);
}

.step-label {
    font-size: 13px;
    color: var(--text-secondary);
    font-weight: 600;
}

.progress-line {
    width: 100px;
    height: 2px;
    background: var(--border-color);
    margin: 0 10px;
    position: relative;
    top: -15px;
}

.setup-step {
    display: none;
}

.setup-step.active {
    display: block;
    animation: fadeIn 0.5s ease;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.setup-title {
    font-size: 28px;
    font-weight: 700;
    text-align: center;
    margin-bottom: 10px;
    color: var(--text-primary);
}

.setup-description {
    text-align: center;
    color: var(--text-secondary);
    margin-bottom: 30px;
    font-size: 15px;
}

/* Avatar Upload */
.avatar-upload-section {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
    margin: 40px 0;
}

.avatar-preview {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    overflow: hidden;
    position: relative;
    cursor: pointer;
    border: 4px solid var(--border-color);
    transition: var(--transition);
}

.avatar-preview:hover {
    border-color: var(--primary-color);
    transform: scale(1.05);
}

.avatar-preview img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.avatar-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: var(--transition);
}

.avatar-preview:hover .avatar-overlay {
    opacity: 1;
}

.avatar-overlay svg {
    width: 40px;
    height: 40px;
    color: white;
}

.btn-upload {
    background: var(--primary-gradient);
    color: white;
    padding: 12px 30px;
    border-radius: var(--radius-md);
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: var(--transition);
}

.btn-upload:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
}

.btn-upload svg {
    width: 20px;
    height: 20px;
}

.upload-hint {
    font-size: 13px;
    color: var(--text-tertiary);
}

.upload-progress {
    width: 100%;
    margin: 20px 0;
}

.progress-bar {
    width: 100%;
    height: 8px;
    background: var(--bg-secondary);
    border-radius: 4px;
    overflow: hidden;
    margin-bottom: 10px;
}

.progress-fill {
    height: 100%;
    background: var(--primary-gradient);
    width: 0%;
    transition: width 0.3s ease;
}

.progress-text {
    text-align: center;
    font-size: 14px;
    color: var(--text-secondary);
}

/* Link Card */
.link-card {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: var(--radius-lg);
    padding: 25px;
    color: white;
    margin: 30px 0;
}

.link-card-header {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 20px;
}

.link-card-logo {
    width: 50px;
    height: 50px;
    background: white;
    border-radius: var(--radius-md);
    padding: 8px;
}

.link-card-info {
    flex: 1;
}

.link-card-title {
    font-size: 16px;
    font-weight: 600;
    opacity: 0.9;
}

.link-card-subtitle {
    font-size: 14px;
    opacity: 0.8;
}

.link-display {
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    padding: 15px;
    border-radius: var(--radius-md);
    font-size: 14px;
    word-break: break-all;
    margin-bottom: 15px;
    border: 1px solid rgba(255, 255, 255, 0.3);
}

.btn-copy {
    width: 100%;
    background: white;
    color: var(--primary-color);
    padding: 12px;
    border-radius: var(--radius-md);
    font-weight: 600;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: var(--transition);
}

.btn-copy:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
}

.btn-copy svg {
    width: 20px;
    height: 20px;
}

/* Link Stats */
.link-stats {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
    margin: 30px 0;
}

.link-stat-item {
    background: var(--bg-secondary);
    padding: 20px;
    border-radius: var(--radius-lg);
    text-align: center;
}

.link-stat-icon {
    font-size: 32px;
    margin-bottom: 10px;
}

.link-stat-value {
    font-size: 28px;
    font-weight: 700;
    color: var(--primary-color);
    margin-bottom: 5px;
}

.link-stat-label {
    font-size: 13px;
    color: var(--text-secondary);
}

/* Share Section */
.share-section {
    margin: 30px 0;
}

.share-section-title {
    font-size: 18px;
    font-weight: 700;
    margin-bottom: 20px;
    color: var(--text-primary);
}

.share-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 15px;
    margin-bottom: 20px;
}

.share-card {
    background: white;
    border: 2px solid var(--border-color);
    padding: 20px 10px;
    border-radius: var(--radius-lg);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
    transition: var(--transition);
}

.share-card:hover {
    border-color: var(--primary-color);
    transform: translateY(-3px);
    box-shadow: var(--shadow-md);
}

.share-card-icon {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
}

.share-card-icon svg {
    width: 24px;
    height: 24px;
}

.share-card-icon.whatsapp { background: #25D366; }
.share-card-icon.instagram { background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%); }
.share-card-icon.snapchat { background: #FFFC00; color: #000; }
.share-card-icon.tiktok { background: #000; }
.share-card-icon.facebook { background: #1877F2; }
.share-card-icon.twitter { background: #1DA1F2; }
.share-card-icon.telegram { background: #0088cc; }
.share-card-icon.more { background: var(--bg-secondary); color: var(--text-secondary); }

.share-card-name {
    font-size: 13px;
    font-weight: 600;
    color: var(--text-primary);
}

.share-tip {
    background: #fef3c7;
    border: 1px solid #fcd34d;
    padding: 15px;
    border-radius: var(--radius-md);
    display: flex;
    align-items: flex-start;
    gap: 12px;
}

.share-tip svg {
    width: 24px;
    height: 24px;
    color: #f59e0b;
    flex-shrink: 0;
}

.share-tip p {
    font-size: 14px;
    color: #92400e;
    margin: 0;
    line-height: 1.5;
}

/* Setup Actions */
.setup-actions {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 40px;
    gap: 15px;
}

.btn-skip {
    background: transparent;
    color: var(--text-secondary);
    padding: 12px 24px;
    border-radius: var(--radius-md);
    font-weight: 600;
    transition: var(--transition);
}

.btn-skip:hover {
    background: var(--bg-secondary);
    color: var(--text-primary);
}

.btn-back {
    background: var(--bg-secondary);
    color: var(--text-primary);
    padding: 12px 24px;
    border-radius: var(--radius-md);
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: var(--transition);
}

.btn-back:hover {
    background: var(--bg-tertiary);
    transform: translateX(-3px);
}

.btn-back svg {
    width: 20px;
    height: 20px;
}

.btn-continue, .btn-finish {
    background: var(--primary-gradient);
    color: white;
    padding: 12px 24px;
    border-radius: var(--radius-md);
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: var(--transition);
}

.btn-continue:hover, .btn-finish:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
}

.btn-continue svg, .btn-finish svg {
    width: 20px;
    height: 20px;
}

/* ============================================
   HOME CONTENT
   ============================================ */
.home-content {
    max-width: 1000px;
    margin: 0 auto;
    padding: 40px 20px;
}

.home-container {
    display: flex;
    flex-direction: column;
    gap: 25px;
}

.home-welcome {
    text-align: center;
    margin-bottom: 20px;
}

.home-title {
    font-size: 32px;
    font-weight: 700;
    margin-bottom: 10px;
    color: var(--text-primary);
}

.home-subtitle {
    font-size: 16px;
    color: var(--text-secondary);
}

/* Quick Actions */
.home-quick-actions {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 20px;
}

.quick-action-card {
    background: white;
    border: 2px solid var(--border-color);
    border-radius: var(--radius-lg);
    padding: 25px;
    display: flex;
    align-items: center;
    gap: 15px;
    transition: var(--transition);
    position: relative;
}

.quick-action-card:hover {
    border-color: var(--primary-color);
    transform: translateY(-3px);
    box-shadow: var(--shadow-md);
}

.quick-action-icon {
    width: 56px;
    height: 56px;
    background: var(--primary-gradient);
    color: white;
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.quick-action-icon svg {
    width: 28px;
    height: 28px;
}

.quick-action-info {
    flex: 1;
}

.quick-action-title {
    font-size: 18px;
    font-weight: 700;
    margin-bottom: 3px;
    color: var(--text-primary);
}

.quick-action-desc {
    font-size: 14px;
    color: var(--text-secondary);
}

.quick-action-badge {
    position: absolute;
    top: 15px;
    right: 15px;
    background: #ef4444;
    color: white;
    font-size: 13px;
    font-weight: 700;
    padding: 4px 10px;
    border-radius: 12px;
    min-width: 24px;
    text-align: center;
}

/* Home Stats Card */
.home-stats-card {
    background: white;
    border-radius: var(--radius-lg);
    padding: 30px;
    box-shadow: var(--shadow-sm);
}

.stats-card-title {
    font-size: 20px;
    font-weight: 700;
    margin-bottom: 20px;
    color: var(--text-primary);
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
}

.stat-item {
    text-align: center;
    padding: 20px;
    background: var(--bg-secondary);
    border-radius: var(--radius-md);
}

.stat-icon {
    font-size: 36px;
    margin-bottom: 10px;
}

.stat-value {
    font-size: 32px;
    font-weight: 700;
    color: var(--primary-color);
    margin-bottom: 5px;
}

.stat-label {
    font-size: 14px;
    color: var(--text-secondary);
    font-weight: 500;
}

/* Home Link Card */
.home-link-card {
    background: var(--primary-gradient);
    border-radius: var(--radius-lg);
    padding: 30px;
    color: white;
}

.link-card-title {
    font-size: 20px;
    font-weight: 700;
    margin-bottom: 15px;
}

.link-display-home {
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    padding: 15px;
    border-radius: var(--radius-md);
    font-size: 14px;
    word-break: break-all;
    margin-bottom: 15px;
    border: 1px solid rgba(255, 255, 255, 0.3);
}

.btn-copy-home {
    width: 100%;
    background: white;
    color: var(--primary-color);
    padding: 12px;
    border-radius: var(--radius-md);
    font-weight: 600;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: var(--transition);
}

.btn-copy-home:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
}

.btn-copy-home svg {
    width: 20px;
    height: 20px;
}

/* ============================================
   SETTINGS MODAL
   ============================================ */
.modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    z-index: 1000;
    display: none;
    align-items: center;
    justify-content: center;
    padding: 20px;
}

.modal.active {
    display: flex;
}

.modal-backdrop {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(5px);
    animation: fadeIn 0.3s ease;
}

.modal-content {
    position: relative;
    background: white;
    border-radius: var(--radius-xl);
    width: 100%;
    max-width: 500px;
    max-height: 90vh;
    overflow: hidden;
    box-shadow: var(--shadow-xl);
    animation: slideUp 0.3s ease;
}

.modal-header {
    padding: 25px;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.modal-title {
    font-size: 22px;
    font-weight: 700;
    color: var(--text-primary);
}

.modal-close {
    width: 36px;
    height: 36px;
    background: var(--bg-secondary);
    color: var(--text-secondary);
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: var(--transition);
}

.modal-close:hover {
    background: var(--bg-tertiary);
    color: var(--text-primary);
}

.modal-close svg {
    width: 20px;
    height: 20px;
}

.modal-body {
    padding: 20px 25px;
    max-height: calc(90vh - 100px);
    overflow-y: auto;
}

/* Settings Section */
.settings-section {
    margin-bottom: 30px;
}

.settings-section:last-child {
    margin-bottom: 0;
}

.settings-section-title {
    font-size: 14px;
    font-weight: 700;
    text-transform: uppercase;
    color: var(--text-tertiary);
    margin-bottom: 15px;
    letter-spacing: 0.5px;
}

.settings-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 15px;
    border-radius: var(--radius-md);
    margin-bottom: 8px;
    transition: var(--transition);
}

.settings-item.clickable {
    cursor: pointer;
}

.settings-item.clickable:hover {
    background: var(--bg-secondary);
}

.settings-item.danger {
    color: #ef4444;
}

.settings-item.danger:hover {
    background: #fee;
}

.settings-item-info {
    display: flex;
    align-items: center;
    gap: 15px;
}

.settings-icon {
    width: 24px;
    height: 24px;
    color: var(--text-tertiary);
    flex-shrink: 0;
}

.settings-item.danger .settings-icon {
    color: #ef4444;
}

.settings-item-title {
    font-size: 15px;
    font-weight: 600;
    margin-bottom: 2px;
}

.settings-item-desc {
    font-size: 13px;
    color: var(--text-tertiary);
}

.settings-arrow {
    width: 20px;
    height: 20px;
    color: var(--text-tertiary);
}

/* ============================================
   TOAST NOTIFICATION
   ============================================ */
.toast {
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%) translateY(100px);
    background: white;
    padding: 15px 25px;
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-xl);
    display: flex;
    align-items: center;
    gap: 12px;
    z-index: 10001;
    opacity: 0;
    transition: all 0.3s ease;
    max-width: 90%;
}

.toast.show {
    transform: translateX(-50%) translateY(0);
    opacity: 1;
}

.toast-icon {
    width: 24px;
    height: 24px;
    color: #10b981;
    flex-shrink: 0;
}

.toast-message {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
}

/* ============================================
   RESPONSIVE DESIGN
   ============================================ */
@media (max-width: 768px) {
    .header-inner {
        padding: 12px 15px;
    }

    .logo-text {
        display: none;
    }

    .nav-icon {
        width: 44px;
        height: 44px;
    }

    .auth-box {
        padding: 30px 20px;
    }

    .setup-card {
        padding: 25px 20px;
    }

    .progress-line {
        width: 60px;
    }

    .setup-title {
        font-size: 24px;
    }

    .share-grid {
        grid-template-columns: repeat(3, 1fr);
    }

    .stats-grid {
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
    }

    .stat-item {
        padding: 15px 10px;
    }

    .stat-icon {
        font-size: 28px;
    }

    .stat-value {
        font-size: 24px;
    }

    .stat-label {
        font-size: 12px;
    }

    .home-title {
        font-size: 26px;
    }

    .home-quick-actions {
        grid-template-columns: 1fr;
    }

    .setup-actions {
        flex-direction: column;
        gap: 10px;
    }

    .btn-skip, .btn-back, .btn-continue, .btn-finish {
        width: 100%;
        justify-content: center;
    }

    .stat-preview-value {
        font-size: 20px;
    }

    .slide-title {
        font-size: 24px;
    }

    .link-stats {
        grid-template-columns: 1fr;
    }
}

@media (max-width: 480px) {
    .onboarding-slides {
        height: 60vh;
    }

    .slide-content {
        padding: 10px;
    }

    .slide-logo {
        width: 70px;
        height: 70px;
    }

    .slide-icon {
        width: 60px;
        height: 60px;
    }

    .slide-title {
        font-size: 22px;
    }

    .slide-description {
        font-size: 14px;
    }

    .share-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
    }

    .share-card {
        padding: 15px 8px;
    }

    .share-card-icon {
        width: 40px;
        height: 40px;
    }

    .share-card-icon svg {
        width: 20px;
        height: 20px;
    }

    .stats-preview {
        grid-template-columns: 1fr;
    }

    .auth-title {
        font-size: 28px;
    }

    .home-content {
        padding: 20px 15px;
    }

    .modal-content {
        max-width: 100%;
        border-radius: var(--radius-lg);
    }
}

/* ============================================
   UTILITY CLASSES
   ============================================ */
.hidden {
    display: none !important;
}

.text-center {
    text-align: center;
}

.mt-10 {
    margin-top: 10px;
}

.mt-20 {
    margin-top: 20px;
}

.mb-10 {
    margin-bottom: 10px;
}

.mb-20 {
    margin-bottom: 20px;
}

/* ============================================
   SCROLLBAR STYLING
   ============================================ */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: var(--bg-secondary);
}

::-webkit-scrollbar-thumb {
    background: var(--text-tertiary);
    border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--text-secondary);
}

/* ============================================
   ANIMATIONS
   ============================================ */
@keyframes pulse {
    0%, 100% {
        opacity: 1;
    }
    50% {
        opacity: 0.5;
    }
}

.loading {
    animation: pulse 1.5s ease-in-out infinite;
}

/* ============================================
   DARK MODE SUPPORT (Optional)
   ============================================ */
@media (prefers-color-scheme: dark) {
    /* Vous pouvez ajouter un mode sombre ici si n√©cessaire */
}

/* ============================================
   PRINT STYLES
   ============================================ */
@media print {
    .header,
    .settings-modal,
    .toast,
    .btn-skip,
    .onboarding-nav {
        display: none !important;
    }
}

/* ============================================
   ACCESSIBILITY
   ============================================ */
.visually-hidden {
    position: absolute;
    width: 1px;
    height: 1px;
    margin: -1px;
    padding: 0;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

/* Focus visible for keyboard navigation */
*:focus-visible {
    outline: 2px solid var(--primary-color);
    outline-offset: 2px;
}

button:focus-visible,
a:focus-visible,
input:focus-visible {
    outline: 2px solid var(--primary-color);
    outline-offset: 2px;
}

/* Reduce motion for users who prefer it */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}
    </style>

    <!-- JavaScript -->
    <script type="module">
// ===== FIREBASE CONFIGURATION =====
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, collection, query, where, getDocs, doc, setDoc, updateDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
import { getDatabase, ref as dbRef, set, update, onDisconnect } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig = {
    apiKey: "AIzaSyBqk3L_qkolD41H3yvHEzz4O-Sr15I-Tko",
    authDomain: "gandxoanonymous.firebaseapp.com",
    projectId: "gandxoanonymous",
    storageBucket: "gandxoanonymous.appspot.com",
    messagingSenderId: "836606625364",
    appId: "1:836606625364:web:7150571998131c41c0cfc1",
    measurementId: "G-97TCHJ33KW",
    databaseURL: "https://gandxoanonymous-default-rtdb.firebaseio.com"
};

const CLOUDINARY_CLOUD_NAME = 'duddyzckz';
const CLOUDINARY_UPLOAD_PRESET = 'ml_defaulte';

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const rtdb = getDatabase(app);

let currentUser = null;
let currentUserData = null;
let currentSlide = 0;
let deferredPrompt = null;

// ===== DOM ELEMENTS =====
const loaderScreen = document.getElementById('loaderScreen');
const onboardingScreen = document.getElementById('onboardingScreen');
const authContainer = document.getElementById('authContainer');
const mainApp = document.getElementById('mainApp');

const skipBtn = document.getElementById('skipBtn');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const startBtn = document.getElementById('startBtn');
const slideIndicators = document.querySelectorAll('.indicator');
const onboardingSlides = document.querySelectorAll('.onboarding-slide');

const loginTab = document.getElementById('loginTab');
const registerTab = document.getElementById('registerTab');
const loginForm = document.getElementById('loginForm');
const registerForm = document.getElementById('registerForm');
const authError = document.getElementById('authError');
const authSuccess = document.getElementById('authSuccess');

const registerUsername = document.getElementById('registerUsername');
const registerEmail = document.getElementById('registerEmail');
const registerPassword = document.getElementById('registerPassword');
const previewPseudo = document.getElementById('previewPseudo');

const loginEmail = document.getElementById('loginEmail');
const loginPassword = document.getElementById('loginPassword');

const profileSetupContainer = document.getElementById('profileSetupContainer');
const homeContent = document.getElementById('homeContent');
const step1 = document.getElementById('step1');
const step2 = document.getElementById('step2');
const step3 = document.getElementById('step3');

const photoInput = document.getElementById('photoInput');
const avatarPreview = document.getElementById('avatarPreview');
const avatarImage = document.getElementById('avatarImage');
const uploadProgress = document.getElementById('uploadProgress');
const progressFill = document.getElementById('progressFill');
const progressText = document.getElementById('progressText');
const skipPhotoBtn = document.getElementById('skipPhotoBtn');
const continueStep1 = document.getElementById('continueStep1');

const userPseudoDisplay = document.getElementById('userPseudoDisplay');
const userLinkDisplay = document.getElementById('userLinkDisplay');
const copyLinkBtn = document.getElementById('copyLinkBtn');
const linkMessages = document.getElementById('linkMessages');
const linkViews = document.getElementById('linkViews');
const backStep2 = document.getElementById('backStep2');
const continueStep2 = document.getElementById('continueStep2');

const shareWhatsApp = document.getElementById('shareWhatsApp');
const shareInstagram = document.getElementById('shareInstagram');
const shareSnapchat = document.getElementById('shareSnapchat');
const shareTikTok = document.getElementById('shareTikTok');
const shareFacebook = document.getElementById('shareFacebook');
const shareTwitter = document.getElementById('shareTwitter');
const shareTelegram = document.getElementById('shareTelegram');
const shareMore = document.getElementById('shareMore');
const backStep3 = document.getElementById('backStep3');
const finishBtn = document.getElementById('finishBtn');

const settingsBtn = document.getElementById('settingsBtn');
const settingsModal = document.getElementById('settingsModal');
const closeSettingsModal = document.getElementById('closeSettingsModal');
const logoutBtnModal = document.getElementById('logoutBtnModal');

const toast = document.getElementById('toast');
const toastMessage = document.getElementById('toastMessage');

// ===== INITIALIZATION =====
document.addEventListener('DOMContentLoaded', () => {
    console.log('‚úÖ SIS App Started');
    
    initEventListeners();
    initPWA();
    
    setTimeout(() => {
        if (loaderScreen) loaderScreen.classList.add('hidden');
    }, 1500);
});

// ===== AUTH STATE =====
onAuthStateChanged(auth, async (user) => {
    console.log('üîê Auth State Changed');
    
    if (user) {
        console.log('‚úÖ User Logged In:', user.uid);
        currentUser = user;
        
        setupPresence(user.uid);
        
        try {
            await loadUserData();
        } catch (error) {
            console.error('‚ùå Load User Error:', error);
            showToast('Erreur de chargement');
            
            setTimeout(() => {
                showAuth();
            }, 2000);
        }
    } else {
        console.log('‚ùå No User');
        currentUser = null;
        currentUserData = null;
        
        const hasSeenOnboarding = localStorage.getItem('hasSeenOnboarding');
        
        if (!hasSeenOnboarding) {
            showOnboarding();
        } else {
            showAuth();
        }
    }
});

// ===== PRESENCE SYSTEM =====
function setupPresence(uid) {
    const userStatusRef = dbRef(rtdb, `users/${uid}`);
    
    update(userStatusRef, {
        online: true,
        lastSeen: new Date().toISOString()
    }).catch(err => console.log('Presence update failed:', err));
    
    onDisconnect(userStatusRef).update({
        online: false,
        lastSeen: new Date().toISOString()
    });
}

// ===== ONBOARDING =====
function showOnboarding() {
    console.log('üì± Showing Onboarding');
    if (onboardingScreen) onboardingScreen.classList.add('active');
    if (authContainer) authContainer.classList.remove('active');
    if (mainApp) mainApp.classList.remove('active');
    updateSlide(0);
}

function updateSlide(index) {
    currentSlide = index;
    
    onboardingSlides.forEach((slide, i) => {
        slide.classList.toggle('active', i === index);
    });
    
    slideIndicators.forEach((indicator, i) => {
        indicator.classList.toggle('active', i === index);
    });
    
    if (prevBtn) prevBtn.style.visibility = index === 0 ? 'hidden' : 'visible';
    
    if (index === onboardingSlides.length - 1) {
        if (nextBtn) nextBtn.style.display = 'none';
        if (startBtn) startBtn.style.display = 'flex';
    } else {
        if (nextBtn) nextBtn.style.display = 'flex';
        if (startBtn) startBtn.style.display = 'none';
    }
    
    const slidesContainer = document.getElementById('onboardingSlides');
    if (slidesContainer) {
        slidesContainer.style.transform = `translateX(-${index * 100}%)`;
    }
}

function completeOnboarding() {
    console.log('‚úÖ Onboarding Completed');
    localStorage.setItem('hasSeenOnboarding', 'true');
    if (onboardingScreen) onboardingScreen.classList.remove('active');
    showAuth();
}

// ===== AUTH =====
function showAuth() {
    console.log('üîê Showing Auth');
    if (authContainer) authContainer.classList.add('active');
    if (onboardingScreen) onboardingScreen.classList.remove('active');
    if (mainApp) mainApp.classList.remove('active');
}

function showMainApp() {
    console.log('üè† Showing Main App');
    if (mainApp) mainApp.classList.add('active');
    if (authContainer) authContainer.classList.remove('active');
    if (onboardingScreen) onboardingScreen.classList.remove('active');
}

function switchAuthTab(tab) {
    if (tab === 'login') {
        if (loginTab) loginTab.classList.add('active');
        if (registerTab) registerTab.classList.remove('active');
        if (loginForm) loginForm.classList.add('active');
        if (registerForm) registerForm.classList.remove('active');
    } else {
        if (registerTab) registerTab.classList.add('active');
        if (loginTab) loginTab.classList.remove('active');
        if (registerForm) registerForm.classList.add('active');
        if (loginForm) loginForm.classList.remove('active');
    }
    hideMessages();
}

function showError(message) {
    console.log('‚ùå Error:', message);
    if (authError) {
        authError.textContent = message;
        authError.classList.add('show');
    }
    if (authSuccess) authSuccess.classList.remove('show');
}

function showSuccess(message) {
    console.log('‚úÖ Success:', message);
    if (authSuccess) {
        authSuccess.textContent = message;
        authSuccess.classList.add('show');
    }
    if (authError) authError.classList.remove('show');
}

function hideMessages() {
    if (authError) authError.classList.remove('show');
    if (authSuccess) authSuccess.classList.remove('show');
}

async function handleRegister(e) {
    e.preventDefault();
    hideMessages();
    
    const username = registerUsername.value.trim().toLowerCase();
    const email = registerEmail.value.trim();
    const password = registerPassword.value;
    
    console.log('üìù Register Attempt:', username, email);
    
    if (!username || !email || !password) {
        showError('Veuillez remplir tous les champs');
        return;
    }
    
    if (!/^[a-zA-Z0-9_]{3,20}$/.test(username)) {
        showError('Pseudo invalide (3-20 caract√®res, lettres, chiffres et _)');
        return;
    }
    
    if (password.length < 6) {
        showError('Mot de passe trop court (min 6 caract√®res)');
        return;
    }
    
    const registerBtn = document.getElementById('registerBtn');
    if (registerBtn) {
        registerBtn.disabled = true;
        registerBtn.innerHTML = '<span class="btn-text">Inscription...</span>';
    }
    
    try {
        console.log('üîç Checking username...');
        const usernameExists = await checkUsernameExists(username);
        
        if (usernameExists) {
            showError('Ce pseudo est d√©j√† utilis√©');
            if (registerBtn) {
                registerBtn.disabled = false;
                registerBtn.innerHTML = '<span class="btn-text">S\'inscrire</span>';
            }
            return;
        }
        
        console.log('üë§ Creating Firebase Auth user...');
        const userCredential = await createUserWithEmailAndPassword(auth, email, password);
        const user = userCredential.user;
        
        console.log('‚úÖ User Created:', user.uid);
        
        const timestamp = new Date().toISOString();
        const link = `https://sis-send.vercel.app/index.html?to=${username}`;
        
        const userData = {
            uid: user.uid,
            username: username,
            email: email,
            photoURL: `https://ui-avatars.com/api/?name=${username}&background=667eea&color=fff&size=200`,
            createdAt: timestamp,
            updatedAt: timestamp,
            link: link,
            messageCount: 0,
            viewCount: 0,
            hasCompletedSetup: false
        };
        
        console.log('üíæ Saving to Firestore...');
        await setDoc(doc(db, 'users', user.uid), userData);
        
        console.log('üîó Saving username mapping...');
        await setDoc(doc(db, 'usernames', username), {
            uid: user.uid,
            createdAt: timestamp
        });
        
        console.log('üìä Saving to Realtime Database...');
        await set(dbRef(rtdb, `users/${user.uid}`), {
            uid: user.uid,
            username: username,
            email: email,
            photoURL: userData.photoURL,
            createdAt: timestamp,
            link: link,
            online: true
        });
        
        console.log('‚úÖ Registration Complete!');
        showSuccess('Inscription r√©ussie !');
        
    } catch (error) {
        console.error('‚ùå Registration Error:', error);
        
        if (registerBtn) {
            registerBtn.disabled = false;
            registerBtn.innerHTML = '<span class="btn-text">S\'inscrire</span>';
        }
        
        if (error.code === 'auth/email-already-in-use') {
            showError('Cet email est d√©j√† utilis√©');
        } else if (error.code === 'auth/invalid-email') {
            showError('Email invalide');
        } else if (error.code === 'auth/weak-password') {
            showError('Mot de passe trop faible');
        } else {
            showError('Erreur: ' + error.message);
        }
    }
}

async function handleLogin(e) {
    e.preventDefault();
    hideMessages();
    
    const email = loginEmail.value.trim();
    const password = loginPassword.value;
    
    console.log('üîë Login Attempt:', email);
    
    if (!email || !password) {
        showError('Veuillez remplir tous les champs');
        return;
    }
    
    const loginBtn = document.getElementById('loginBtn');
    if (loginBtn) {
        loginBtn.disabled = true;
        loginBtn.innerHTML = '<span class="btn-text">Connexion...</span>';
    }
    
    try {
        await signInWithEmailAndPassword(auth, email, password);
        console.log('‚úÖ Login Successful');
        showSuccess('Connexion r√©ussie !');
    } catch (error) {
        console.error('‚ùå Login Error:', error);
        
        if (loginBtn) {
            loginBtn.disabled = false;
            loginBtn.innerHTML = '<span class="btn-text">Se connecter</span>';
        }
        
        if (error.code === 'auth/invalid-credential' || error.code === 'auth/wrong-password') {
            showError('Email ou mot de passe incorrect');
        } else if (error.code === 'auth/user-not-found') {
            showError('Compte introuvable');
        } else if (error.code === 'auth/too-many-requests') {
            showError('Trop de tentatives. R√©essayez plus tard.');
        } else {
            showError('Erreur: ' + error.message);
        }
    }
}

async function checkUsernameExists(username) {
    try {
        const usernameDoc = await getDoc(doc(db, 'usernames', username));
        return usernameDoc.exists();
    } catch (error) {
        console.error('Error checking username:', error);
        
        try {
            const q = query(collection(db, 'users'), where('username', '==', username));
            const querySnapshot = await getDocs(q);
            return !querySnapshot.empty;
        } catch (fallbackError) {
            console.error('Fallback check failed:', fallbackError);
            return false;
        }
    }
}

async function handleLogout() {
    try {
        if (currentUser) {
            await update(dbRef(rtdb, `users/${currentUser.uid}`), {
                online: false,
                lastSeen: new Date().toISOString()
            }).catch(err => console.log('Realtime DB update failed:', err));
        }
        
        await signOut(auth);
        console.log('üëã Logout Successful');
        showToast('D√©connexion r√©ussie');
        
        if (settingsModal) settingsModal.classList.remove('active');
    } catch (error) {
        console.error('‚ùå Logout Error:', error);
        showToast('Erreur de d√©connexion');
    }
}

// ===== LOAD USER DATA =====
async function loadUserData() {
    if (!currentUser) {
        console.error('‚ùå No current user');
        return;
    }
    
    console.log('üì• Loading User Data:', currentUser.uid);
    
    try {
        console.log('üì° Fetching from Firestore...');
        const userDoc = await getDoc(doc(db, 'users', currentUser.uid));
        
        if (!userDoc.exists()) {
            console.error('‚ùå User Document Not Found');
            showToast('Compte introuvable. Veuillez vous r√©inscrire.');
            setTimeout(() => handleLogout(), 2000);
            return;
        }
        
        currentUserData = userDoc.data();
        console.log('‚úÖ User Data Loaded:', currentUserData);
        
        const username = currentUserData.username;
        const link = `https://sis-send.vercel.app/index.html?to=${username}`;
        
        if (userPseudoDisplay) userPseudoDisplay.textContent = `@${username}`;
        if (userLinkDisplay) userLinkDisplay.textContent = link;
        
        if (currentUserData.photoURL) {
            if (avatarImage) avatarImage.src = currentUserData.photoURL;
            const headerAvatar = document.getElementById('userAvatarHeader');
            if (headerAvatar) headerAvatar.src = currentUserData.photoURL;
        }
        
        if (linkMessages) linkMessages.textContent = currentUserData.messageCount || 0;
        if (linkViews) linkViews.textContent = currentUserData.viewCount || 0;
        
        if (!currentUserData.hasCompletedSetup) {
            console.log('‚öôÔ∏è Setup Incomplete');
            showMainApp();
            setTimeout(() => showProfileSetup(), 300);
        } else {
            console.log('‚úÖ Setup Complete - Showing Home');
            showMainApp();
            setTimeout(() => showHomeContent(), 300);
        }
        
    } catch (error) {
        console.error('‚ùå Load User Data Error:', error);
        showToast('Erreur de chargement: ' + error.message);
        
        setTimeout(() => {
            showAuth();
        }, 3000);
    }
}

// ===== PROFILE SETUP =====
function showProfileSetup() {
    console.log('‚öôÔ∏è Showing Profile Setup');
    if (profileSetupContainer) {
        profileSetupContainer.style.display = 'block';
    }
    if (homeContent) {
        homeContent.style.display = 'none';
    }
    goToStep(1);
}

function showHomeContent() {
    console.log('üè† Showing Home Content');
    
    if (profileSetupContainer) {
        profileSetupContainer.style.display = 'none';
    }
    
    if (homeContent) {
        homeContent.style.display = 'block';
        
        if (currentUserData) {
            const link = `https://sis-send.vercel.app/index.html?to=${currentUserData.username}`;
            
            const homeLinkDisplay = document.getElementById('homeLinkDisplay');
            const homeStatsMessages = document.getElementById('homeStatsMessages');
            const homeStatsViews = document.getElementById('homeStatsViews');
            const homeMessagesBadge = document.getElementById('homeMessagesBadge');
            const messagesBadge = document.getElementById('messagesBadge');
            
            if (homeLinkDisplay) homeLinkDisplay.textContent = link;
            if (homeStatsMessages) homeStatsMessages.textContent = currentUserData.messageCount || 0;
            if (homeStatsViews) homeStatsViews.textContent = currentUserData.viewCount || 0;
            if (homeMessagesBadge) homeMessagesBadge.textContent = currentUserData.messageCount || 0;
            if (messagesBadge) messagesBadge.textContent = currentUserData.messageCount || 0;
        }
    }
}

function goToStep(stepNumber) {
    console.log('‚û°Ô∏è Going to Step:', stepNumber);
    
    if (step1) step1.classList.remove('active');
    if (step2) step2.classList.remove('active');
    if (step3) step3.classList.remove('active');
    
    if (stepNumber === 1 && step1) step1.classList.add('active');
    else if (stepNumber === 2 && step2) step2.classList.add('active');
    else if (stepNumber === 3 && step3) step3.classList.add('active');
    
    document.querySelectorAll('.progress-step').forEach((step, index) => {
        if (index < stepNumber) {
            step.classList.add('active');
        } else {
            step.classList.remove('active');
        }
    });
}

async function uploadPhoto(file) {
    console.log('üì§ Uploading Photo:', file.name);
    
    if (!file) {
        console.error('‚ùå No file provided');
        return null;
    }
    
    if (!file.type.startsWith('image/')) {
        showToast('Veuillez s√©lectionner une image');
        return null;
    }
    
    if (file.size > 5 * 1024 * 1024) {
        showToast('Image trop grande (max 5MB)');
        return null;
    }
    
    try {
        if (uploadProgress) uploadProgress.style.display = 'block';
        if (progressFill) progressFill.style.width = '0%';
        if (progressText) progressText.textContent = '0%';
        
        const formData = new FormData();
        formData.append('file', file);
        formData.append('upload_preset', CLOUDINARY_UPLOAD_PRESET);
        formData.append('cloud_name', CLOUDINARY_CLOUD_NAME);
        
        const xhr = new XMLHttpRequest();
        
        return new Promise((resolve, reject) => {
            xhr.upload.addEventListener('progress', (e) => {
                if (e.lengthComputable) {
                    const percent = Math.round((e.loaded / e.total) * 100);
                    if (progressFill) progressFill.style.width = percent + '%';
                    if (progressText) progressText.textContent = percent + '%';
                }
            });
            
            xhr.addEventListener('load', () => {
                if (uploadProgress) uploadProgress.style.display = 'none';
                
                if (xhr.status === 200) {
                    const response = JSON.parse(xhr.responseText);
                    console.log('‚úÖ Upload Success:', response.secure_url);
                    resolve(response.secure_url);
                } else {
                    console.error('‚ùå Upload Failed:', xhr.status);
                    reject(new Error('Upload failed'));
                }
            });
            
            xhr.addEventListener('error', () => {
                if (uploadProgress) uploadProgress.style.display = 'none';
                console.error('‚ùå Upload Error');
                reject(new Error('Network error'));
            });
            
            xhr.open('POST', `https://api.cloudinary.com/v1_1/${CLOUDINARY_CLOUD_NAME}/image/upload`);
            xhr.send(formData);
        });
        
    } catch (error) {
        console.error('‚ùå Upload Error:', error);
        if (uploadProgress) uploadProgress.style.display = 'none';
        showToast('Erreur d\'upload: ' + error.message);
        return null;
    }
}

async function handlePhotoSelection(e) {
    const file = e.target.files[0];
    if (!file) return;
    
    console.log('üñºÔ∏è Photo Selected:', file.name);
    
    const reader = new FileReader();
    reader.onload = (e) => {
        if (avatarImage) {
            avatarImage.src = e.target.result;
        }
        if (avatarPreview) {
            avatarPreview.style.display = 'block';
        }
    };
    reader.readAsDataURL(file);
    
    if (continueStep1) continueStep1.disabled = false;
}

async function handleStep1Continue() {
    console.log('‚û°Ô∏è Step 1 Continue');
    
    const file = photoInput?.files[0];
    
    if (!file) {
        console.log('‚è≠Ô∏è No photo - moving to step 2');
        goToStep(2);
        return;
    }
    
    if (continueStep1) {
        continueStep1.disabled = true;
        continueStep1.innerHTML = '<span class="btn-text">Upload...</span>';
    }
    
    try {
        const photoURL = await uploadPhoto(file);
        
        if (photoURL && currentUser) {
            console.log('üíæ Saving Photo URL...');
            
            await updateDoc(doc(db, 'users', currentUser.uid), {
                photoURL: photoURL,
                updatedAt: new Date().toISOString()
            });
            
            await update(dbRef(rtdb, `users/${currentUser.uid}`), {
                photoURL: photoURL
            }).catch(err => console.log('RTDB update failed:', err));
            
            if (currentUserData) {
                currentUserData.photoURL = photoURL;
            }
            
            const headerAvatar = document.getElementById('userAvatarHeader');
            if (headerAvatar) headerAvatar.src = photoURL;
            
            console.log('‚úÖ Photo Saved');
            showToast('Photo mise √† jour !');
        }
        
        goToStep(2);
        
    } catch (error) {
        console.error('‚ùå Step 1 Error:', error);
        showToast('Erreur de sauvegarde');
    } finally {
        if (continueStep1) {
            continueStep1.disabled = false;
            continueStep1.innerHTML = `
                <span class="btn-text">Continuer</span>
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2"/>
                </svg>
            `;
        }
    }
}

function handleSkipPhoto() {
    console.log('‚è≠Ô∏è Skip Photo');
    goToStep(2);
}

async function handleStep2Continue() {
    console.log('‚û°Ô∏è Step 2 Continue');
    goToStep(3);
}

function handleStep2Back() {
    console.log('‚¨ÖÔ∏è Back to Step 1');
    goToStep(1);
}

function handleStep3Back() {
    console.log('‚¨ÖÔ∏è Back to Step 2');
    goToStep(2);
}

async function handleFinishSetup() {
    console.log('‚úÖ Finishing Setup');
    
    if (finishBtn) {
        finishBtn.disabled = true;
        finishBtn.innerHTML = '<span class="btn-text">Finalisation...</span>';
    }
    
    try {
        if (currentUser) {
            await updateDoc(doc(db, 'users', currentUser.uid), {
                hasCompletedSetup: true,
                updatedAt: new Date().toISOString()
            });
            
            if (currentUserData) {
                currentUserData.hasCompletedSetup = true;
            }
            
            console.log('‚úÖ Setup Complete');
            showToast('Configuration termin√©e !');
            
            setTimeout(() => {
                showHomeContent();
            }, 500);
        }
    } catch (error) {
        console.error('‚ùå Finish Setup Error:', error);
        showToast('Erreur de sauvegarde');
        
        if (finishBtn) {
            finishBtn.disabled = false;
            finishBtn.innerHTML = `
                <span class="btn-text">Terminer la configuration</span>
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M22 11.08V12C21.9988 14.1564 21.3005 16.2547 20.0093 17.9818C18.7182 19.7088 16.9033 20.9725 14.8354 21.5839C12.7674 22.1953 10.5573 22.1219 8.53447 21.3746C6.51168 20.6273 4.78465 19.2461 3.61096 17.4371C2.43727 15.628 1.87979 13.4881 2.02168 11.3363C2.16356 9.18455 2.99721 7.13631 4.39828 5.49706C5.79935 3.85781 7.69279 2.71537 9.79619 2.24013C11.8996 1.7649 14.1003 1.98232 16.07 2.85999" stroke="currentColor" stroke-width="2"/>
                    <path d="M22 4L12 14.01L9 11.01" stroke="currentColor" stroke-width="2"/>
                </svg>
            `;
        }
    }
}

// ===== SHARING =====
function copyLink() {
    if (!currentUserData) return;
    
    const link = `https://sis-send.vercel.app/index.html?to=${currentUserData.username}`;
    
    if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(link)
            .then(() => {
                console.log('üìã Link Copied');
                showToast('Lien copi√© !');
            })
            .catch(err => {
                console.error('‚ùå Copy Failed:', err);
                fallbackCopy(link);
            });
    } else {
        fallbackCopy(link);
    }
}

function fallbackCopy(text) {
    const textArea = document.createElement('textarea');
    textArea.value = text;
    textArea.style.position = 'fixed';
    textArea.style.left = '-999999px';
    document.body.appendChild(textArea);
    textArea.select();
    
    try {
        document.execCommand('copy');
        console.log('üìã Link Copied (fallback)');
        showToast('Lien copi√© !');
    } catch (err) {
        console.error('‚ùå Fallback Copy Failed:', err);
        showToast('Erreur de copie');
    }
    
    document.body.removeChild(textArea);
}

function shareLink(platform) {
    if (!currentUserData) return;
    
    const link = `https://sis-send.vercel.app/index.html?to=${currentUserData.username}`;
    const text = `Envoie-moi un message anonyme sur SIS ! ${link}`;
    
    console.log('üì§ Sharing to:', platform);
    
    let shareUrl = '';
    
    switch(platform) {
        case 'whatsapp':
            shareUrl = `https://wa.me/?text=${encodeURIComponent(text)}`;
            break;
        case 'instagram':
            copyLink();
            showToast('Collez le lien dans Instagram');
            return;
        case 'snapchat':
            shareUrl = `https://www.snapchat.com/scan?attachmentUrl=${encodeURIComponent(link)}`;
            break;
        case 'tiktok':
            copyLink();
            showToast('Collez le lien dans TikTok');
            return;
        case 'facebook':
            shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(link)}`;
            break;
        case 'twitter':
            shareUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}`;
            break;
        case 'telegram':
            shareUrl = `https://t.me/share/url?url=${encodeURIComponent(link)}&text=${encodeURIComponent(text)}`;
            break;
        case 'more':
            if (navigator.share) {
                navigator.share({
                    title: 'Mon lien SIS',
                    text: text,
                    url: link
                }).catch(err => console.log('Share cancelled:', err));
            } else {
                copyLink();
            }
            return;
    }
    
    if (shareUrl) {
        window.open(shareUrl, '_blank');
    }
}

// ===== UI HELPERS =====
function showToast(message, duration = 3000) {
    console.log('üçû Toast:', message);
    
    if (toastMessage) toastMessage.textContent = message;
    if (toast) {
        toast.classList.add('show');
        
        setTimeout(() => {
            toast.classList.remove('show');
        }, duration);
    }
}

function openSettings() {
    console.log('‚öôÔ∏è Opening Settings');
    if (settingsModal) settingsModal.classList.add('active');
}

function closeSettings() {
    console.log('‚öôÔ∏è Closing Settings');
    if (settingsModal) settingsModal.classList.remove('active');
}

// ===== PWA =====
function initPWA() {
    console.log('üì± Initializing PWA');
    
    createInstallBanner();
    
    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        console.log('‚úÖ Install Prompt Ready');
        
        setTimeout(() => {
            showInstallBanner();
        }, 3000);
    });
    
    window.addEventListener('appinstalled', () => {
        console.log('‚úÖ App Installed');
        deferredPrompt = null;
        hideInstallBanner();
        showToast('App install√©e avec succ√®s ! üéâ');
    });
    
    if (window.matchMedia('(display-mode: standalone)').matches) {
        console.log('üì± Running as PWA');
    }
}

function createInstallBanner() {
    if (document.getElementById('installBanner')) return;
    
    const banner = document.createElement('div');
    banner.id = 'installBanner';
    banner.className = 'install-banner';
    banner.style.display = 'none';
    
    banner.innerHTML = `
        <div class="install-banner-content">
            <img src="https://i.ibb.co/tGCTMvk/logo.png" alt="SIS" class="install-banner-icon">
            <div class="install-banner-text">
                <h3>Installer SIS</h3>
                <p>Acc√®s rapide depuis votre √©cran d'accueil</p>
            </div>
            <button class="install-banner-btn" id="installBannerBtn">Installer</button>
            <button class="install-banner-close" id="installBannerClose">‚úï</button>
        </div>
    `;
    
    document.body.appendChild(banner);
    addInstallBannerStyles();
    
    const installBtn = document.getElementById('installBannerBtn');
    const closeBtn = document.getElementById('installBannerClose');
    
    if (installBtn) {
        installBtn.addEventListener('click', promptInstall);
    }
    
    if (closeBtn) {
        closeBtn.addEventListener('click', () => {
            hideInstallBanner();
            localStorage.setItem('installBannerDismissed', 'true');
        });
    }
}

function addInstallBannerStyles() {
    if (document.getElementById('installBannerStyles')) return;
    
    const style = document.createElement('style');
    style.id = 'installBannerStyles';
    style.textContent = `
        .install-banner {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 16px;
            padding: 16px 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            z-index: 10000;
            max-width: 90%;
            width: 400px;
            animation: slideUpBanner 0.3s ease;
        }
        
        @keyframes slideUpBanner {
            from { 
                transform: translateX(-50%) translateY(100px); 
                opacity: 0; 
            }
            to { 
                transform: translateX(-50%) translateY(0); 
                opacity: 1; 
            }
        }
        
        .install-banner-content {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .install-banner-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            flex-shrink: 0;
        }
        
        .install-banner-text {
            flex: 1;
        }
        
        .install-banner-text h3 {
            margin: 0;
            font-size: 16px;
            font-weight: 600;
        }
        
        .install-banner-text p {
            margin: 4px 0 0 0;
            font-size: 13px;
            opacity: 0.9;
        }
        
        .install-banner-btn {
            background: white;
            color: #667eea;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            flex-shrink: 0;
        }
        
        .install-banner-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .install-banner-btn:active {
            transform: scale(0.98);
        }
        
        .install-banner-close {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            transition: all 0.2s;
        }
        
        .install-banner-close:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .install-banner-close:active {
            transform: scale(0.9);
        }
        
        @media (max-width: 480px) {
            .install-banner {
                width: calc(100% - 32px);
                bottom: 16px;
                padding: 12px 16px;
            }
            
            .install-banner-content {
                gap: 8px;
            }
            
            .install-banner-icon {
                width: 40px;
                height: 40px;
            }
            
            .install-banner-text h3 {
                font-size: 14px;
            }
            
            .install-banner-text p {
                font-size: 12px;
            }
            
            .install-banner-btn {
                padding: 8px 16px;
                font-size: 14px;
            }
            
            .install-banner-close {
                width: 28px;
                height: 28px;
                font-size: 16px;
            }
        }
    `;
    
    document.head.appendChild(style);
}

function showInstallBanner() {
    if (localStorage.getItem('installBannerDismissed') === 'true') {
        console.log('üì± Install banner dismissed by user');
        return;
    }
    
    const banner = document.getElementById('installBanner');
    if (banner) {
        banner.style.display = 'block';
        console.log('üì± Install banner shown');
    }
}

function hideInstallBanner() {
    const banner = document.getElementById('installBanner');
    if (banner) {
        banner.style.display = 'none';
        console.log('üì± Install banner hidden');
    }
}

async function promptInstall() {
    if (!deferredPrompt) {
        console.log('‚ùå No install prompt available');
        showToast('Installation non disponible');
        return;
    }
    
    console.log('üì• Showing Install Prompt');
    hideInstallBanner();
    deferredPrompt.prompt();
    
    const { outcome } = await deferredPrompt.userChoice;
    console.log('Install outcome:', outcome);
    
    if (outcome === 'accepted') {
        console.log('‚úÖ User accepted install');
        showToast('Installation en cours...');
    } else {
        console.log('‚ùå User dismissed install');
        showToast('Installation annul√©e');
    }
    
    deferredPrompt = null;
}

// ===== EVENT LISTENERS =====
function initEventListeners() {
    console.log('üéß Initializing Event Listeners');
    
    if (skipBtn) skipBtn.addEventListener('click', completeOnboarding);
    if (prevBtn) prevBtn.addEventListener('click', () => updateSlide(currentSlide - 1));
    if (nextBtn) nextBtn.addEventListener('click', () => updateSlide(currentSlide + 1));
    if (startBtn) startBtn.addEventListener('click', completeOnboarding);
    
    slideIndicators.forEach((indicator, index) => {
        indicator.addEventListener('click', () => updateSlide(index));
    });
    
    if (loginTab) loginTab.addEventListener('click', () => switchAuthTab('login'));
    if (registerTab) registerTab.addEventListener('click', () => switchAuthTab('register'));
    
    if (registerForm) registerForm.addEventListener('submit', handleRegister);
    if (loginForm) loginForm.addEventListener('submit', handleLogin);
    
    if (registerUsername) {
        registerUsername.addEventListener('input', (e) => {
            const username = e.target.value.trim().toLowerCase();
            if (previewPseudo) {
                previewPseudo.textContent = username ? `@${username}` : '@username';
            }
        });
    }
    
    if (photoInput) photoInput.addEventListener('change', handlePhotoSelection);
    if (skipPhotoBtn) skipPhotoBtn.addEventListener('click', handleSkipPhoto);
    if (continueStep1) continueStep1.addEventListener('click', handleStep1Continue);
    if (backStep2) backStep2.addEventListener('click', handleStep2Back);
    if (continueStep2) continueStep2.addEventListener('click', handleStep2Continue);
    if (backStep3) backStep3.addEventListener('click', handleStep3Back);
    if (finishBtn) finishBtn.addEventListener('click', handleFinishSetup);
    
    if (copyLinkBtn) copyLinkBtn.addEventListener('click', copyLink);
    
    const homeCopyBtn = document.getElementById('copyLinkHomeBtn');
    if (homeCopyBtn) homeCopyBtn.addEventListener('click', copyLink);
    
    if (shareWhatsApp) shareWhatsApp.addEventListener('click', () => shareLink('whatsapp'));
    if (shareInstagram) shareInstagram.addEventListener('click', () => shareLink('instagram'));
    if (shareSnapchat) shareSnapchat.addEventListener('click', () => shareLink('snapchat'));
    if (shareTikTok) shareTikTok.addEventListener('click', () => shareLink('tiktok'));
    if (shareFacebook) shareFacebook.addEventListener('click', () => shareLink('facebook'));
    if (shareTwitter) shareTwitter.addEventListener('click', () => shareLink('twitter'));
    if (shareTelegram) shareTelegram.addEventListener('click', () => shareLink('telegram'));
    if (shareMore) shareMore.addEventListener('click', () => shareLink('more'));
    
    const viewMessagesBtn = document.getElementById('viewMessagesBtn');
    const shareLinkBtn = document.getElementById('shareLinkBtn');
    const viewFeedBtn = document.getElementById('viewFeedBtn');
    
    if (viewMessagesBtn) {
        viewMessagesBtn.addEventListener('click', () => {
            showToast('Section Messages bient√¥t disponible');
        });
    }
    
    if (shareLinkBtn) {
        shareLinkBtn.addEventListener('click', () => {
            if (profileSetupContainer) profileSetupContainer.style.display = 'block';
            if (homeContent) homeContent.style.display = 'none';
            goToStep(3);
        });
    }
    
    if (viewFeedBtn) {
        viewFeedBtn.addEventListener('click', () => {
            showToast('Feed Social bient√¥t disponible');
        });
    }
    
    const homeNavBtn = document.getElementById('homeNavBtn');
    const feedNavBtn = document.getElementById('feedNavBtn');
    const messagesNavBtn = document.getElementById('messagesNavBtn');
    
    if (homeNavBtn) {
        homeNavBtn.addEventListener('click', () => {
            document.querySelectorAll('.nav-icon').forEach(btn => btn.classList.remove('active'));
            homeNavBtn.classList.add('active');
            
            if (currentUserData?.hasCompletedSetup) {
                showHomeContent();
            }
        });
    }
    
    if (feedNavBtn) {
        feedNavBtn.addEventListener('click', () => {
            document.querySelectorAll('.nav-icon').forEach(btn => btn.classList.remove('active'));
            feedNavBtn.classList.add('active');
            showToast('Feed Social bient√¥t disponible');
        });
    }
    
    if (messagesNavBtn) {
        messagesNavBtn.addEventListener('click', () => {
            document.querySelectorAll('.nav-icon').forEach(btn => btn.classList.remove('active'));
            messagesNavBtn.classList.add('active');
            showToast('Section Messages bient√¥t disponible');
        });
    }
    
    if (settingsBtn) settingsBtn.addEventListener('click', openSettings);
    if (closeSettingsModal) closeSettingsModal.addEventListener('click', closeSettings);
    if (logoutBtnModal) logoutBtnModal.addEventListener('click', handleLogout);
    
    const settingsViewMessages = document.getElementById('settingsViewMessages');
    const settingsShareLink = document.getElementById('settingsShareLink');
    
    if (settingsViewMessages) {
        settingsViewMessages.addEventListener('click', () => {
            closeSettings();
            showToast('Section Messages bient√¥t disponible');
        });
    }
    
    if (settingsShareLink) {
        settingsShareLink.addEventListener('click', () => {
            closeSettings();
            if (profileSetupContainer) profileSetupContainer.style.display = 'block';
            if (homeContent) homeContent.style.display = 'none';
            goToStep(3);
        });
    }
    
    if (settingsModal) {
        settingsModal.addEventListener('click', (e) => {
            if (e.target === settingsModal || e.target.classList.contains('modal-backdrop')) {
                closeSettings();
            }
        });
    }
    
    console.log('‚úÖ Event Listeners Initialized');
}

console.log('üöÄ SIS App JavaScript Loaded Successfully');
</script>
</body>
</html>
                  
